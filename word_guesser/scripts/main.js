'use strict';function B(k,a,d,g){k.L.Hc(k.Nc,a,d,g,void 0)}function E(k,a,d){return k.L.Jg(k.Nc,a,d,void 0,void 0)}function K(k,a,d,g){k.L.hb?B(k,a,d,g):k.L.Lk()._OnMessageFromDOM({type:"event",component:k.Nc,handler:a,dispatchOpts:g||null,data:d,responseId:null})}function L(k,a,d){k.L.W(k.Nc,a,d)}function M(k,a){for(const [d,g]of a)L(k,d,g)}function N(k){k.ie||(k.L.rk(k.Th),k.ie=!0)}window.zb=class{constructor(k,a){this.L=k;this.Nc=a;this.ie=!1;this.Th=()=>this.va()}tg(){}va(){}};
function O(k){-1!==k.yc&&(self.clearTimeout(k.yc),k.yc=-1)}window.Dj=class{constructor(k,a){this.Hf=k;this.Mm=a;this.yc=-1;this.je=-Infinity;this.Uh=()=>{this.yc=-1;this.je=Date.now();this.Vc=!0;this.Hf();this.Vc=!1};this.rh=this.Vc=!1}Ye(){this.Vc||(O(this),this.je=Date.now())}o(){O(this);this.Uh=this.Hf=null}};"use strict";function P(k,a){L(k,"get-element",d=>{const g=k.bb.get(d.elementId);return a(g,d)})}
window.un=class extends self.zb{constructor(k,a){super(k,a);this.bb=new Map;this.Ff=!0;M(this,[["create",()=>{throw Error("required override");}],["destroy",d=>{{d=d.elementId;const g=this.bb.get(d);this.Ff&&g.parentElement.removeChild(g);this.bb.delete(d)}}],["set-visible",d=>{this.Ff&&(this.bb.get(d.elementId).style.display=d.isVisible?"":"none")}],["update-position",d=>{if(this.Ff){var g=this.bb.get(d.elementId);g.style.left=d.left+"px";g.style.top=d.top+"px";g.style.width=d.width+"px";g.style.height=
d.height+"px";d=d.fontSize;null!==d&&(g.style.fontSize=d+"em")}}],["update-state",d=>{this.bb.get(d.elementId);throw Error("required override");}],["focus",d=>this.zf(d)],["set-css-style",d=>{this.bb.get(d.elementId).style[d.prop]=d.val}],["set-attribute",d=>{this.bb.get(d.elementId).setAttribute(d.name,d.val)}],["remove-attribute",d=>{this.bb.get(d.elementId).removeAttribute(d.name)}]]);P(this,d=>d)}zf(k){var a=this.bb.get(k.elementId);k.focus?a.focus():a.blur()}};"use strict";
{const k=/(iphone|ipod|ipad|macos|macintosh|mac os x)/i.test(navigator.userAgent),a=/android/i.test(navigator.userAgent);let d=0;function g(w){const l=document.createElement("script");l.async=!1;l.type="module";return w.bn?new Promise(u=>{const y="c3_resolve_"+d;++d;self[y]=u;l.textContent=w.ln+`\n\nself["${y}"]();`;document.head.appendChild(l)}):new Promise((u,y)=>{l.onload=u;l.onerror=y;l.src=w;document.head.appendChild(l)})}let n=!1,t=!1;function h(){if(!n){try{new Worker("blob://",{get type(){t=
!0}})}catch(w){}n=!0}return t}let c=new Audio;const f={"audio/webm; codecs=opus":!!c.canPlayType("audio/webm; codecs=opus"),"audio/ogg; codecs=opus":!!c.canPlayType("audio/ogg; codecs=opus"),"audio/webm; codecs=vorbis":!!c.canPlayType("audio/webm; codecs=vorbis"),"audio/ogg; codecs=vorbis":!!c.canPlayType("audio/ogg; codecs=vorbis"),"audio/mp4":!!c.canPlayType("audio/mp4"),"audio/mpeg":!!c.canPlayType("audio/mpeg")};c=null;async function b(w){w=await e(w);return(new TextDecoder("utf-8")).decode(w)}
function e(w){return new Promise((l,u)=>{const y=new FileReader;y.onload=z=>l(z.target.result);y.onerror=z=>u(z);y.readAsArrayBuffer(w)})}const p=[];let r=0;window.RealFile=window.File;const v=[],x=new Map,C=new Map;let D=0;const H=[];self.runOnStartup=function(w){if("function"!==typeof w)throw Error("runOnStartup called without a function");H.push(w)};const m=new Set(["cordova","playable-ad","instant-games"]);let q=!1;window.Ua=class w{constructor(l){this.hb=l.pn;this.Hb=null;this.fa="";this.ye=
l.jn;this.zd={};this.qc=this.yd=null;this.ee=[];this.ba=this.wc=null;this.zh=!1;this.cd=null;this.vc=-1;this.Tm=()=>this.Bl();this.uc=[];this.K=l.Vh;this.Yc="file"===location.protocol.substr(0,4);!this.hb||"undefined"!==typeof OffscreenCanvas&&navigator.userActivation&&h()||(this.hb=!1);if("playable-ad"===this.K||"instant-games"===this.K)this.hb=!1;if("cordova"===this.K&&this.hb)if(a){const u=/Chrome\/(\d+)/i.exec(navigator.userAgent);u&&90<=parseInt(u[1],10)||(this.hb=!1)}else this.hb=!1;this.oe=
this.qb=null;"html5"!==this.K&&"playable-ad"!==this.K||!this.Yc||alert("Exported games won't work until you upload them. (When running on the file: protocol, browsers block many features from working for security reasons.)");"html5"!==this.K||window.isSecureContext||console.warn("[Construct 3] Warning: the browser indicates this is not a secure context. Some features may be unavailable. Use secure (HTTPS) hosting to ensure all features are available.");this.W("runtime","cordova-fetch-local-file",
u=>this.bl(u));this.W("runtime","create-job-worker",()=>this.cl());"cordova"===this.K?document.addEventListener("deviceready",()=>this.ah(l)):this.ah(l)}o(){this.jf();this.Hb&&(this.Hb=this.Hb.onmessage=null);this.yd&&(this.yd.terminate(),this.yd=null);this.qc&&(this.qc.o(),this.qc=null);this.ba&&(this.ba.parentElement.removeChild(this.ba),this.ba=null)}nj(){return k&&"cordova"===this.K}Te(){const l=navigator.userAgent;return k&&m.has(this.K)||navigator.standalone||/crios\/|fxios\/|edgios\//i.test(l)}kj(){return a}Gg(){return a&&
m.has(this.K)}async ah(l){"macos-wkwebview"===this.K&&this.Df({type:"ready"});if("playable-ad"===this.K){this.qb=self.c3_base64files;this.oe={};await this.yk();for(let y=0,z=l.Ac.length;y<z;++y){var u=l.Ac[y].toLowerCase();this.oe.hasOwnProperty(u)?l.Ac[y]={bn:!0,ln:this.oe[u]}:this.qb.hasOwnProperty(u)&&(l.Ac[y]=URL.createObjectURL(this.qb[u]))}}l.Vm?this.fa=l.Vm:(u=location.origin,this.fa=("null"===u?"file:///":u)+location.pathname,u=this.fa.lastIndexOf("/"),-1!==u&&(this.fa=this.fa.substr(0,u+
1)));l.sn&&(this.zd=l.sn);u=new MessageChannel;this.Hb=u.port1;this.Hb.onmessage=y=>this._OnMessageFromRuntime(y.data);window.c3_addPortMessageHandler&&window.c3_addPortMessageHandler(y=>this.tl(y));this.cd=new self.oj(this);await Q(this.cd);"object"===typeof window.StatusBar&&window.StatusBar.hide();"object"===typeof window.AndroidFullScreen&&window.AndroidFullScreen.immersiveMode();this.hb?await this.Sk(l,u.port2):await this.Rk(l,u.port2)}mf(l){l=this.zd.hasOwnProperty(l)?this.zd[l]:l.endsWith("/workermain.js")&&
this.zd.hasOwnProperty("workermain.js")?this.zd["workermain.js"]:"playable-ad"===this.K&&this.qb.hasOwnProperty(l.toLowerCase())?this.qb[l.toLowerCase()]:l;l instanceof Blob&&(l=URL.createObjectURL(l));return l}async Ke(l,u,y){if(l.startsWith("blob:"))return new Worker(l,y);if("cordova"===this.K&&this.Yc)return l=await this.Bd(y.an?l:this.ye+l),new Worker(URL.createObjectURL(new Blob([l],{type:"application/javascript"})),y);l=new URL(l,u);if(location.origin!==l.origin){l=await fetch(l);if(!l.ok)throw Error("failed to fetch worker script");
l=await l.blob();return new Worker(URL.createObjectURL(l),y)}return new Worker(l,y)}Fb(){return Math.max(window.innerWidth,1)}lb(){return Math.max(window.innerHeight,1)}$g(l){var u=this.cd;return{baseUrl:this.fa,previewUrl:location.href,windowInnerWidth:this.Fb(),windowInnerHeight:this.lb(),devicePixelRatio:window.devicePixelRatio,isFullscreen:w.Ec(),projectData:l.Hn,previewImageBlobs:window.cr_previewImageBlobs||this.qb,previewProjectFileBlobs:window.cr_previewProjectFileBlobs,previewProjectFileSWUrls:window.cr_previewProjectFiles,
swClientId:window.Cn||"",exportType:l.Vh,isDebug:-1<self.location.search.indexOf("debug"),ife:!!self.Gn,jobScheduler:{inputPort:u.Vf,outputPort:u.fg,maxNumWorkers:u.Om},supportedAudioFormats:f,opusWasmScriptUrl:window.cr_opusWasmScriptUrl||this.ye+"opus.wasm.js",opusWasmBinaryUrl:window.cr_opusWasmBinaryUrl||this.ye+"opus.wasm.wasm",isFileProtocol:this.Yc,isiOSCordova:this.nj(),isiOSWebView:this.Te(),isFBInstantAvailable:"undefined"!==typeof self.FBInstant}}async Sk(l,u){var y=this.mf(l.rn);this.yd=
await this.Ke(y,this.fa,{type:"module",name:"Runtime",an:!0});this.ba=document.createElement("canvas");this.ba.style.display="none";y=this.ba.transferControlToOffscreen();document.body.appendChild(this.ba);window.c3canvas=this.ba;let z=l.rg||[],G=l.Ac;z=await Promise.all(z.map(A=>this.ic(A)));G=await Promise.all(G.map(A=>this.ic(A)));if("cordova"===this.K)for(let A=0,F=l.He.length;A<F;++A){const I=l.He[A],J=I[0];if(J===l.og||"scriptsInEvents.js"===J||J.endsWith("/scriptsInEvents.js"))I[1]=await this.ic(J)}this.yd.postMessage(Object.assign(this.$g(l),
{type:"init-runtime",isInWorker:!0,messagePort:u,canvas:y,workerDependencyScripts:z,engineScripts:G,projectScripts:l.He,mainProjectScript:l.og,projectScriptsStatus:self.C3_ProjectScriptsStatus}),[u,y,...R(this.cd)]);this.ee=v.map(A=>new A(this));this.Yg();self.c3_callFunction=(A,F)=>this.wc.Tk(A,F);"preview"===this.K&&(self.goToLastErrorScript=()=>this.Hc("runtime","go-to-last-error-script"))}async Rk(l,u){this.ba=document.createElement("canvas");this.ba.style.display="none";document.body.appendChild(this.ba);
window.c3canvas=this.ba;this.ee=v.map(A=>new A(this));this.Yg();var y=l.Ac.map(A=>"string"===typeof A?(new URL(A,this.fa)).toString():A);Array.isArray(l.rg)&&y.unshift(...l.rg);y=await Promise.all(y.map(A=>this.ic(A)));await Promise.all(y.map(A=>g(A)));y=self.C3_ProjectScriptsStatus;const z=l.og,G=l.He;for(let [A,F]of G)if(F||(F=A),A===z)try{F=await this.ic(F),await g(F),"preview"!==this.K||y[A]||this.lh(A,"main script did not run to completion")}catch(I){this.lh(A,I)}else if("scriptsInEvents.js"===
A||A.endsWith("/scriptsInEvents.js"))F=await this.ic(F),await g(F);"preview"===this.K&&"object"!==typeof self.tn.vn?(this.Vd(),console.error("[C3 runtime] Failed to load JavaScript code used in events. Check all your JavaScript code has valid syntax."),alert("Failed to load JavaScript code used in events. Check all your JavaScript code has valid syntax.")):(l=Object.assign(this.$g(l),{isInWorker:!1,messagePort:u,canvas:this.ba,runOnStartupFunctions:H}),this.dh(),this.qc=self.C3_CreateRuntime(l),await self.C3_InitRuntime(this.qc,
l))}lh(l,u){this.Vd();console.error(`[Preview] Failed to load project main script (${l}): `,u);alert(`Failed to load project main script (${l}). Check all your JavaScript code has valid syntax. Press F12 and check the console for error details.`)}dh(){this.Vd()}Vd(){const l=window.Wm;l&&(l.parentElement.removeChild(l),window.Wm=null)}async cl(){const l=await S(this.cd);return{outputPort:l,transferables:[l]}}Lk(){if(this.hb)throw Error("not available in worker mode");return this.qc}Hc(l,u,y,z,G){this.Hb.postMessage({type:"event",
component:l,handler:u,dispatchOpts:z||null,data:y,responseId:null},G)}Jg(l,u,y,z,G){const A=D++,F=new Promise((I,J)=>{C.set(A,{resolve:I,reject:J})});this.Hb.postMessage({type:"event",component:l,handler:u,dispatchOpts:z||null,data:y,responseId:A},G);return F}["_OnMessageFromRuntime"](l){const u=l.type;if("event"===u)return this.hl(l);if("result"===u)this.El(l);else if("runtime-ready"===u)this.Fl();else if("alert-error"===u)this.Vd(),alert(l.message);else if("creating-runtime"===u)this.dh();else throw Error(`unknown message '${u}'`);
}hl(l){const u=l.component,y=l.handler,z=l.data,G=l.responseId;if(l=x.get(u))if(l=l.get(y)){var A=null;try{A=l(z)}catch(F){console.error(`Exception in '${u}' handler '${y}':`,F);null!==G&&this.Ud(G,!1,""+F);return}if(null===G)return A;A&&A.then?A.then(F=>this.Ud(G,!0,F)).catch(F=>{console.error(`Rejection from '${u}' handler '${y}':`,F);this.Ud(G,!1,""+F)}):this.Ud(G,!0,A)}else console.warn(`[DOM] No handler '${y}' for component '${u}'`);else console.warn(`[DOM] No event handlers for component '${u}'`)}Ud(l,
u,y){let z;y&&y.transferables&&(z=y.transferables);this.Hb.postMessage({type:"result",responseId:l,isOk:u,result:y},z)}El(l){const u=l.responseId,y=l.isOk;l=l.result;const z=C.get(u);y?z.resolve(l):z.reject(l);C.delete(u)}W(l,u,y){let z=x.get(l);z||(z=new Map,x.set(l,z));if(z.has(u))throw Error(`[DOM] Component '${l}' already has handler '${u}'`);z.set(u,y)}static Lb(l){if(v.includes(l))throw Error("DOM handler already added");v.push(l)}Yg(){for(const l of this.ee)if("runtime"===l.Nc){this.wc=l;return}throw Error("cannot find runtime DOM handler");
}tl(l){this.Hc("debugger","message",l)}Fl(){for(const l of this.ee)l.tg()}static Ec(){return!!(document.fullscreenElement||document.webkitFullscreenElement||document.mozFullScreenElement||q)}static Wd(l){q=!!l}rk(l){this.uc.push(l);this.Cf()}fm(l){l=this.uc.indexOf(l);if(-1===l)throw Error("invalid callback");this.uc.splice(l,1);this.uc.length||this.jf()}Cf(){-1===this.vc&&this.uc.length&&(this.vc=requestAnimationFrame(this.Tm))}jf(){-1!==this.vc&&(cancelAnimationFrame(this.vc),this.vc=-1)}Bl(){this.vc=
-1;for(const l of this.uc)l();this.Cf()}Rb(l){this.wc.Rb(l)}hc(l){this.wc.hc(l)}Bf(){this.wc.Bf()}Od(l){this.wc.Od(l)}lj(){return!!f["audio/webm; codecs=opus"]}async Km(l){l=await this.Jg("runtime","opus-decode",{arrayBuffer:l},null,[l]);return new Float32Array(l)}Oj(){this.zh=!0}jj(l){return/^(?:[a-z\-]+:)?\/\//.test(l)||"data:"===l.substr(0,5)||"blob:"===l.substr(0,5)}Ig(l){return!this.jj(l)}async ic(l){return"cordova"===this.K&&(l.startsWith("file:")||this.Yc&&this.Ig(l))?(l.startsWith(this.fa)&&
(l=l.substr(this.fa.length)),l=await this.Bd(l),URL.createObjectURL(new Blob([l],{type:"application/javascript"}))):l}async bl(l){const u=l.filename;switch(l.as){case "text":return await this.Ii(u);case "buffer":return await this.Bd(u);default:throw Error("unsupported type");}}Ag(l){const u=window.cordova.file.applicationDirectory+"www/"+l.toLowerCase();return new Promise((y,z)=>{window.resolveLocalFileSystemURL(u,G=>{G.file(y,z)},z)})}async Ii(l){l=await this.Ag(l);return await b(l)}kf(){if(p.length&&
!(8<=r)){r++;var l=p.shift();this.zk(l.filename,l.mn,l.Zm)}}Bd(l){return new Promise((u,y)=>{p.push({filename:l,mn:z=>{r--;this.kf();u(z)},Zm:z=>{r--;this.kf();y(z)}});this.kf()})}async zk(l,u,y){try{const z=await this.Ag(l),G=await e(z);u(G)}catch(z){y(z)}}Df(l){if("windows-webview2"===this.K)window.chrome.webview.postMessage(JSON.stringify(l));else if("macos-wkwebview"===this.K)window.webkit.messageHandlers.C3Wrapper.postMessage(JSON.stringify(l));else throw Error("cannot send wrapper message");
}async yk(){const l=[];for(const [u,y]of Object.entries(this.qb))l.push(this.xk(u,y));await Promise.all(l)}async xk(l,u){if("object"===typeof u)this.qb[l]=new Blob([u.str],{type:u.type}),this.oe[l]=u.str;else{let y=await this.Ik(u);y||(y=this.Bk(u));this.qb[l]=y}}async Ik(l){try{return await (await fetch(l)).blob()}catch(u){return console.warn("Failed to fetch a data: URI. Falling back to a slower workaround. This is probably because the Content Security Policy unnecessarily blocked it. Allow data: URIs in your CSP to avoid this.",
u),null}}Bk(l){l=this.Zl(l);return this.vk(l.data,l.cn)}Zl(l){var u=l.indexOf(",");if(0>u)throw new URIError("expected comma in data: uri");var y=l.substring(u+1);u=l.substring(5,u).split(";");l=u[0]||"";const z=u[2];y="base64"===u[1]||"base64"===z?atob(y):decodeURIComponent(y);return{cn:l,data:y}}vk(l,u){var y=l.length;let z=y>>2,G=new Uint8Array(y),A=new Uint32Array(G.buffer,0,z),F,I;for(I=F=0;F<z;++F)A[F]=l.charCodeAt(I++)|l.charCodeAt(I++)<<8|l.charCodeAt(I++)<<16|l.charCodeAt(I++)<<24;for(y&=
3;y--;)G[I]=l.charCodeAt(I),++I;return new Blob([G],{type:u})}}}"use strict";
{const k=self.Ua;function a(m){return m.sourceCapabilities&&m.sourceCapabilities.firesTouchEvents||m.originalEvent&&m.originalEvent.sourceCapabilities&&m.originalEvent.sourceCapabilities.firesTouchEvents}const d=new Map([["OSLeft","MetaLeft"],["OSRight","MetaRight"]]),g={dispatchRuntimeEvent:!0,dispatchUserScriptEvent:!0},n={dispatchUserScriptEvent:!0},t={dispatchRuntimeEvent:!0};function h(m){return new Promise((q,w)=>{const l=document.createElement("link");l.onload=()=>q(l);l.onerror=u=>w(u);l.rel=
"stylesheet";l.href=m;document.head.appendChild(l)})}function c(m){return new Promise((q,w)=>{const l=new Image;l.onload=()=>q(l);l.onerror=u=>w(u);l.src=m})}async function f(m){m=URL.createObjectURL(m);try{return await c(m)}finally{URL.revokeObjectURL(m)}}function b(m){return new Promise((q,w)=>{let l=new FileReader;l.onload=u=>q(u.target.result);l.onerror=u=>w(u);l.readAsText(m)})}async function e(m,q,w){if(!/firefox/i.test(navigator.userAgent))return await f(m);var l=await b(m);l=(new DOMParser).parseFromString(l,
"image/svg+xml");const u=l.documentElement;if(u.hasAttribute("width")&&u.hasAttribute("height")){const y=u.getAttribute("width"),z=u.getAttribute("height");if(!y.includes("%")&&!z.includes("%"))return await f(m)}u.setAttribute("width",q+"px");u.setAttribute("height",w+"px");l=(new XMLSerializer).serializeToString(l);m=new Blob([l],{type:"image/svg+xml"});return await f(m)}function p(m){do{if(m.parentNode&&m.hasAttribute("contenteditable"))return!0;m=m.parentNode}while(m);return!1}const r=new Set(["input",
"textarea","datalist","select"]),v=new Set(["canvas","body","html"]);function x(m){v.has(m.target.tagName.toLowerCase())&&m.preventDefault()}function C(m){(m.metaKey||m.ctrlKey)&&m.preventDefault()}self.C3_GetSvgImageSize=async function(m){m=await f(m);if(0<m.width&&0<m.height)return[m.width,m.height];{m.style.position="absolute";m.style.left="0px";m.style.top="0px";m.style.visibility="hidden";document.body.appendChild(m);const q=m.getBoundingClientRect();document.body.removeChild(m);return[q.width,
q.height]}};self.C3_RasterSvgImageBlob=async function(m,q,w,l,u){m=await e(m,q,w);const y=document.createElement("canvas");y.width=l;y.height=u;y.getContext("2d").drawImage(m,0,0,q,w);return y};let D=!1;document.addEventListener("pause",()=>D=!0);document.addEventListener("resume",()=>D=!1);function H(){try{return window.parent&&window.parent.document.hasFocus()}catch(m){return!1}}k.Lb(class extends self.zb{constructor(m){super(m,"runtime");this.Ah=!0;this.xc=-1;this.lg="any";this.mh=this.nh=!1;this.Zb=
null;this.vh="";this.Lf=-1;this.pc=this.pd=null;this.ue=this.te=0;this.Ih=m.Fb();this.me=m.lb();this.vd=0;m.W("canvas","update-size",l=>this.Wl(l));m.W("runtime","invoke-download",l=>this.ql(l));m.W("runtime","raster-svg-image",l=>this.Cl(l));m.W("runtime","get-svg-image-size",l=>this.ml(l));m.W("runtime","set-target-orientation",l=>this.Gl(l));m.W("runtime","register-sw",()=>this.Dl());m.W("runtime","post-to-debugger",l=>this.hh(l));m.W("runtime","go-to-script",l=>this.hh(l));m.W("runtime","before-start-ticking",
()=>this.Zk());m.W("runtime","debug-highlight",l=>this.dl(l));m.W("runtime","enable-device-orientation",()=>this.uk());m.W("runtime","enable-device-motion",()=>this.tk());m.W("runtime","add-stylesheet",l=>this.Xk(l));m.W("runtime","alert",l=>this.sf(l));m.W("runtime","hide-cordova-splash",()=>this.nl());m.W("runtime","set-exporting-to-video",l=>this.om(l));m.W("runtime","export-to-video-progress",l=>this.il(l));m.W("runtime","exported-to-video",l=>this.jl(l));const q=new Set(["input","textarea","datalist"]);
window.addEventListener("contextmenu",l=>{const u=l.target;q.has(u.tagName.toLowerCase())||p(u)||l.preventDefault()});const w=m.ba;window.addEventListener("selectstart",x);window.addEventListener("gesturehold",x);w.addEventListener("selectstart",x);w.addEventListener("gesturehold",x);window.addEventListener("touchstart",x,{passive:!1});"undefined"!==typeof PointerEvent?(window.addEventListener("pointerdown",x,{passive:!1}),w.addEventListener("pointerdown",x)):w.addEventListener("touchstart",x);this.hd=
0;window.addEventListener("mousedown",l=>{1===l.button&&l.preventDefault()});window.addEventListener("mousewheel",C,{passive:!1});window.addEventListener("wheel",C,{passive:!1});window.addEventListener("resize",()=>this.Xl());window.addEventListener("fullscreenchange",()=>this.Jc());window.addEventListener("webkitfullscreenchange",()=>this.Jc());window.addEventListener("mozfullscreenchange",()=>this.Jc());window.addEventListener("fullscreenerror",l=>this.wf(l));window.addEventListener("webkitfullscreenerror",
l=>this.wf(l));window.addEventListener("mozfullscreenerror",l=>this.wf(l));if(m.Te())if(window.visualViewport){let l=Infinity;window.visualViewport.addEventListener("resize",()=>{const u=window.visualViewport.height;u>l&&(document.scrollingElement.scrollTop=0);l=u})}else window.addEventListener("focusout",()=>{{const y=document.activeElement;if(y){var l=y.tagName.toLowerCase();var u=new Set("email number password search tel text url".split(" "));l="textarea"===l?!0:"input"===l?u.has(y.type.toLowerCase()||
"text"):p(y)}else l=!1}l||(document.scrollingElement.scrollTop=0)});self.C3WrapperOnMessage=l=>this.Yl(l);this.rc=new Set;this.pe=new WeakSet;this.Gb=!1}Zk(){"cordova"===this.L.K?(document.addEventListener("pause",()=>this.Af(!0)),document.addEventListener("resume",()=>this.Af(!1))):document.addEventListener("visibilitychange",()=>this.Af(document.hidden));return{isSuspended:!(!document.hidden&&!D)}}tg(){window.addEventListener("focus",()=>this.Lc("window-focus"));window.addEventListener("blur",()=>
{this.Lc("window-blur",{parentHasFocus:H()});this.hd=0});window.addEventListener("focusin",q=>{q=q.target;(r.has(q.tagName.toLowerCase())||p(q))&&this.Lc("keyboard-blur")});window.addEventListener("keydown",q=>this.eh("keydown",q));window.addEventListener("keyup",q=>this.eh("keyup",q));window.addEventListener("dblclick",q=>this.xf("dblclick",q,g));window.addEventListener("wheel",q=>this.vl(q));"undefined"!==typeof PointerEvent?(window.addEventListener("pointerdown",q=>{this.nf(q);this.Kc("pointerdown",
q)}),this.L.hb&&"undefined"!==typeof window.onpointerrawupdate&&self===self.top?(this.pd=new self.Dj(()=>this.Fk(),5),this.pd.rh=!0,window.addEventListener("pointerrawupdate",q=>this.zl(q))):window.addEventListener("pointermove",q=>this.Kc("pointermove",q)),window.addEventListener("pointerup",q=>this.Kc("pointerup",q)),window.addEventListener("pointercancel",q=>this.Kc("pointercancel",q))):(window.addEventListener("mousedown",q=>{this.nf(q);this.yf("pointerdown",q)}),window.addEventListener("mousemove",
q=>this.yf("pointermove",q)),window.addEventListener("mouseup",q=>this.yf("pointerup",q)),window.addEventListener("touchstart",q=>{this.nf(q);this.Td("pointerdown",q)}),window.addEventListener("touchmove",q=>this.Td("pointermove",q)),window.addEventListener("touchend",q=>this.Td("pointerup",q)),window.addEventListener("touchcancel",q=>this.Td("pointercancel",q)));const m=()=>this.Bf();window.addEventListener("pointerup",m,!0);window.addEventListener("touchend",m,!0);window.addEventListener("click",
m,!0);window.addEventListener("keydown",m,!0);window.addEventListener("gamepadconnected",m,!0);this.L.kj()&&!this.L.Gg()&&navigator.virtualKeyboard&&(navigator.virtualKeyboard.overlaysContent=!0,navigator.virtualKeyboard.addEventListener("geometrychange",()=>{this.tf(this.lb(),navigator.virtualKeyboard.boundingRect.height)}))}tf(m,q){document.body.style.transform="";if(0<q){var w=document.activeElement;w&&(w=w.getBoundingClientRect(),m=(w.top+w.bottom)/2-(m-q)/2,m>q&&(m=q),0>m&&(m=0),0<m&&(document.body.style.transform=
`translateY(${-m}px)`))}}Lc(m,q){B(this,m,q||null,t)}Fb(){return this.L.Fb()}lb(){return this.L.lb()}Xl(){const m=this.Fb(),q=this.lb();if(this.L.Gg()){if(this.Ih===m&&q<this.me){this.vd=this.me-q;this.tf(this.me,this.vd);return}0<this.vd&&(this.vd=0,this.tf(q,this.vd));this.Ih=m;this.me=q}this.Lc("window-resize",{innerWidth:m,innerHeight:q,devicePixelRatio:window.devicePixelRatio,isFullscreen:k.Ec()});this.L.Te()&&(-1!==this.xc&&clearTimeout(this.xc),this.ih(m,q,0))}gm(m,q,w){-1!==this.xc&&clearTimeout(this.xc);
this.xc=setTimeout(()=>this.ih(m,q,w),48)}ih(m,q,w){const l=this.Fb(),u=this.lb();this.xc=-1;l!=m||u!=q?this.Lc("window-resize",{innerWidth:l,innerHeight:u,devicePixelRatio:window.devicePixelRatio,isFullscreen:k.Ec()}):10>w&&this.gm(l,u,w+1)}Gl(m){this.lg=m.targetOrientation}Gm(){const m=this.lg;if(screen.orientation&&screen.orientation.lock)screen.orientation.lock(m).catch(q=>console.warn("[Construct 3] Failed to lock orientation: ",q));else try{let q=!1;screen.lockOrientation?q=screen.lockOrientation(m):
screen.webkitLockOrientation?q=screen.webkitLockOrientation(m):screen.mozLockOrientation?q=screen.mozLockOrientation(m):screen.msLockOrientation&&(q=screen.msLockOrientation(m));q||console.warn("[Construct 3] Failed to lock orientation")}catch(q){console.warn("[Construct 3] Failed to lock orientation: ",q)}}Jc(){const m=k.Ec();m&&"any"!==this.lg&&this.Gm();B(this,"fullscreenchange",{isFullscreen:m,innerWidth:this.Fb(),innerHeight:this.lb()})}wf(m){console.warn("[Construct 3] Fullscreen request failed: ",
m);B(this,"fullscreenerror",{isFullscreen:k.Ec(),innerWidth:this.Fb(),innerHeight:this.lb()})}Af(m){m?this.L.jf():this.L.Cf();B(this,"visibilitychange",{hidden:m})}eh(m,q){"Backspace"===q.key&&x(q);const w=d.get(q.code)||q.code;K(this,m,{code:w,key:q.key,which:q.which,repeat:q.repeat,altKey:q.altKey,ctrlKey:q.ctrlKey,metaKey:q.metaKey,shiftKey:q.shiftKey,timeStamp:q.timeStamp},g)}vl(m){B(this,"wheel",{clientX:m.clientX,clientY:m.clientY,pageX:m.pageX,pageY:m.pageY,deltaX:m.deltaX,deltaY:m.deltaY,
deltaZ:m.deltaZ,deltaMode:m.deltaMode,timeStamp:m.timeStamp},g)}xf(m,q,w){a(q)||K(this,m,{button:q.button,buttons:q.buttons,clientX:q.clientX,clientY:q.clientY,pageX:q.pageX,pageY:q.pageY,movementX:q.movementX||0,movementY:q.movementY||0,timeStamp:q.timeStamp},w)}yf(m,q){if(!a(q)){var w=this.hd;"pointerdown"===m&&0!==w?m="pointermove":"pointerup"===m&&0!==q.buttons&&(m="pointermove");K(this,m,{pointerId:1,pointerType:"mouse",button:q.button,buttons:q.buttons,lastButtons:w,clientX:q.clientX,clientY:q.clientY,
pageX:q.pageX,pageY:q.pageY,movementX:q.movementX||0,movementY:q.movementY||0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,timeStamp:q.timeStamp},g);this.hd=q.buttons;this.xf(q.type,q,n)}}Kc(m,q){this.pd&&"pointermove"!==m&&this.pd.Ye();var w=0;"mouse"===q.pointerType&&(w=this.hd);K(this,m,{pointerId:q.pointerId,pointerType:q.pointerType,button:q.button,buttons:q.buttons,lastButtons:w,clientX:q.clientX,clientY:q.clientY,pageX:q.pageX,pageY:q.pageY,movementX:(q.movementX||
0)+this.te,movementY:(q.movementY||0)+this.ue,width:q.width||0,height:q.height||0,pressure:q.pressure||0,tangentialPressure:q.tangentialPressure||0,tiltX:q.tiltX||0,tiltY:q.tiltY||0,twist:q.twist||0,timeStamp:q.timeStamp},g);this.ue=this.te=0;"mouse"===q.pointerType&&(w="mousemove","pointerdown"===m?w="mousedown":"pointerup"===m&&(w="mouseup"),this.xf(w,q,n),this.hd=q.buttons)}zl(m){this.pc&&(this.te+=this.pc.movementX||0,this.ue+=this.pc.movementY||0);this.pc=m;m=this.pd;if(-1===m.yc){var q=Date.now(),
w=q-m.je,l=m.Mm;w>=l&&m.rh?(m.je=q,m.Vc=!0,m.Hf(),m.Vc=!1):m.yc=self.setTimeout(m.Uh,Math.max(l-w,4))}}Fk(){this.Kc("pointermove",this.pc);this.pc=null}Td(m,q){for(let w=0,l=q.changedTouches.length;w<l;++w){const u=q.changedTouches[w];K(this,m,{pointerId:u.identifier,pointerType:"touch",button:0,buttons:0,lastButtons:0,clientX:u.clientX,clientY:u.clientY,pageX:u.pageX,pageY:u.pageY,movementX:q.movementX||0,movementY:q.movementY||0,width:2*(u.radiusX||u.webkitRadiusX||0),height:2*(u.radiusY||u.webkitRadiusY||
0),pressure:u.force||u.webkitForce||0,tangentialPressure:0,tiltX:0,tiltY:0,twist:u.rotationAngle||0,timeStamp:q.timeStamp},g)}}nf(m){window!==window.top&&window.focus();this.bh(m.target)&&document.activeElement&&!this.bh(document.activeElement)&&document.activeElement.blur()}bh(m){return!m||m===document||m===window||m===document.body||"canvas"===m.tagName.toLowerCase()}uk(){this.nh||(this.nh=!0,window.addEventListener("deviceorientation",m=>this.fl(m)),window.addEventListener("deviceorientationabsolute",
m=>this.gl(m)))}tk(){this.mh||(this.mh=!0,window.addEventListener("devicemotion",m=>this.el(m)))}fl(m){B(this,"deviceorientation",{absolute:!!m.absolute,alpha:m.alpha||0,beta:m.beta||0,gamma:m.gamma||0,timeStamp:m.timeStamp,webkitCompassHeading:m.webkitCompassHeading,webkitCompassAccuracy:m.webkitCompassAccuracy},g)}gl(m){B(this,"deviceorientationabsolute",{absolute:!!m.absolute,alpha:m.alpha||0,beta:m.beta||0,gamma:m.gamma||0,timeStamp:m.timeStamp},g)}el(m){let q=null;var w=m.acceleration;w&&(q=
{x:w.x||0,y:w.y||0,z:w.z||0});w=null;var l=m.accelerationIncludingGravity;l&&(w={x:l.x||0,y:l.y||0,z:l.z||0});l=null;const u=m.rotationRate;u&&(l={alpha:u.alpha||0,beta:u.beta||0,gamma:u.gamma||0});B(this,"devicemotion",{acceleration:q,accelerationIncludingGravity:w,rotationRate:l,interval:m.interval,timeStamp:m.timeStamp},g)}Wl(m){var q=this.L;q.zh||(q=q.ba,q.style.width=m.styleWidth+"px",q.style.height=m.styleHeight+"px",q.style.marginLeft=m.marginLeft+"px",q.style.marginTop=m.marginTop+"px",this.Ah&&
(q.style.display="",this.Ah=!1))}ql(m){const q=m.url;m=m.filename;const w=document.createElement("a"),l=document.body;w.textContent=m;w.href=q;w.download=m;l.appendChild(w);w.click();l.removeChild(w)}async Cl(m){var q=m.imageBitmapOpts;m=await self.C3_RasterSvgImageBlob(m.blob,m.imageWidth,m.imageHeight,m.surfaceWidth,m.surfaceHeight);q=q?await createImageBitmap(m,q):await createImageBitmap(m);return{imageBitmap:q,transferables:[q]}}async ml(m){return await self.C3_GetSvgImageSize(m.blob)}async Xk(m){await h(m.url)}Bf(){var m=
[...this.rc];this.rc.clear();if(!this.Gb)for(const q of m)(m=q.play())&&m.catch(()=>{this.pe.has(q)||this.rc.add(q)})}Rb(m){if("function"!==typeof m.play)throw Error("missing play function");this.pe.delete(m);let q;try{q=m.play()}catch(w){this.rc.add(m);return}q&&q.catch(()=>{this.pe.has(m)||this.rc.add(m)})}hc(m){this.rc.delete(m);this.pe.add(m)}Od(m){this.Gb=!!m}nl(){navigator.splashscreen&&navigator.splashscreen.hide&&navigator.splashscreen.hide()}dl(m){if(m.show){this.Zb||(this.Zb=document.createElement("div"),
this.Zb.id="inspectOutline",document.body.appendChild(this.Zb));var q=this.Zb;q.style.display="";q.style.left=m.left-1+"px";q.style.top=m.top-1+"px";q.style.width=m.width+2+"px";q.style.height=m.height+2+"px";q.textContent=m.name}else this.Zb&&(this.Zb.style.display="none")}Dl(){window.C3_RegisterSW&&window.C3_RegisterSW()}hh(m){window.c3_postToMessagePort&&(m.from="runtime",window.c3_postToMessagePort(m))}Tk(m,q){return E(this,"js-invoke-function",{name:m,params:q})}sf(m){alert(m.message)}Yl(m){"entered-fullscreen"===
m?(k.Wd(!0),this.Jc()):"exited-fullscreen"===m?(k.Wd(!1),this.Jc()):console.warn("Unknown wrapper message: ",m)}om(m){const q=document.createElement("h1");q.id="exportToVideoMessage";q.textContent=m.message;document.body.prepend(q);document.body.classList.add("exportingToVideo");this.L.ba.style.display="";this.L.Oj()}il(m){this.vh=m.message;-1===this.Lf&&(this.Lf=setTimeout(()=>this.Gk(),250))}Gk(){this.Lf=-1;const m=document.getElementById("exportToVideoMessage");m&&(m.textContent=this.vh)}jl(m){window.Bn({type:"exported-video",
blob:m.blob,time:m.time})}})}"use strict";async function Q(k){if(k.Lm)throw Error("already initialised");k.Lm=!0;var a=k.xe.mf("dispatchworker.js");k.Kf=await k.xe.Ke(a,k.fa,{name:"DispatchWorker"});a=new MessageChannel;k.Vf=a.port1;k.Kf.postMessage({type:"_init","in-port":a.port2},[a.port2]);k.fg=await S(k)}function R(k){return[k.Vf,k.fg]}
async function S(k){const a=k.Bh.length;var d=k.xe.mf("jobworker.js");d=await k.xe.Ke(d,k.fa,{name:"JobWorker"+a});const g=new MessageChannel,n=new MessageChannel;k.Kf.postMessage({type:"_addJobWorker",port:g.port1},[g.port1]);d.postMessage({type:"init",number:a,"dispatch-port":g.port2,"output-port":n.port2},[g.port2,n.port2]);k.Bh.push(d);return n.port1}
self.oj=class{constructor(k){this.xe=k;this.fa=k.fa;this.fa="preview"===k.K?this.fa+"workers/":this.fa+k.ye;this.Om=Math.min(navigator.hardwareConcurrency||2,16);this.Kf=null;this.Bh=[];this.fg=this.Vf=null}};"use strict";window.C3_IsSupported&&(window.c3_runtimeInterface=new self.Ua({pn:!0,rn:"workermain.js",Ac:["scripts/c3runtime.js"],He:[],og:"",jn:"scripts/",rg:[],Vh:"html5"}));"use strict";
self.Ua.Lb(class extends self.zb{constructor(k){super(k,"mouse");M(this,[["cursor",a=>{document.documentElement.style.cursor=a}],["request-pointer-lock",()=>{this.L.ba.requestPointerLock()}],["release-pointer-lock",()=>{document.exitPointerLock()}]]);document.addEventListener("pointerlockchange",()=>{B(this,"pointer-lock-change",{"has-pointer-lock":!!document.pointerLockElement})});document.addEventListener("pointerlockerror",()=>{B(this,"pointer-lock-error",{"has-pointer-lock":!!document.pointerLockElement})})}});
"use strict";async function T(k,a){a=a.type;let d=!0;0===a?d=await U():1===a&&(d=await V());B(k,"permission-result",{type:a,result:d})}async function U(){if(!self.DeviceOrientationEvent||!self.DeviceOrientationEvent.requestPermission)return!0;try{return"granted"===await self.DeviceOrientationEvent.requestPermission()}catch(k){return console.warn("[Touch] Failed to request orientation permission: ",k),!1}}
async function V(){if(!self.DeviceMotionEvent||!self.DeviceMotionEvent.requestPermission)return!0;try{return"granted"===await self.DeviceMotionEvent.requestPermission()}catch(k){return console.warn("[Touch] Failed to request motion permission: ",k),!1}}self.Ua.Lb(class extends self.zb{constructor(k){super(k,"touch");L(this,"request-permission",a=>T(this,a))}});"use strict";
function W(k){window.C3_RegisterSW&&window.OfflineClientInfo&&window.OfflineClientInfo.SetMessageCallback(a=>B(k,"sw-message",a.data))}
function X(k){k=k.orientation;if(screen.orientation&&screen.orientation.lock)screen.orientation.lock(k).catch(a=>console.warn("[Construct 3] Failed to lock orientation: ",a));else try{let a=!1;screen.lockOrientation?a=screen.lockOrientation(k):screen.webkitLockOrientation?a=screen.webkitLockOrientation(k):screen.mozLockOrientation?a=screen.mozLockOrientation(k):screen.msLockOrientation&&(a=screen.msLockOrientation(k));a||console.warn("[Construct 3] Failed to lock orientation")}catch(a){console.warn("[Construct 3] Failed to lock orientation: ",
a)}}
self.Ua.Lb(class extends self.zb{constructor(k){super(k,"browser");this.K="";M(this,[["get-initial-state",a=>{this.K=a.exportType;return{location:location.toString(),isOnline:!!navigator.onLine,referrer:document.referrer,title:document.title,isCookieEnabled:!!navigator.cookieEnabled,screenWidth:screen.width,screenHeight:screen.height,windowOuterWidth:window.outerWidth,windowOuterHeight:window.outerHeight,isConstructArcade:"undefined"!==typeof window.is_scirra_arcade}}],["ready-for-sw-messages",()=>
W(this)],["alert",a=>this.sf(a)],["close",()=>this.uf()],["set-focus",a=>this.zf(a)],["vibrate",a=>{navigator.vibrate&&navigator.vibrate(a.pattern)}],["lock-orientation",a=>X(a)],["unlock-orientation",()=>{try{screen.orientation&&screen.orientation.unlock?screen.orientation.unlock():screen.unlockOrientation?screen.unlockOrientation():screen.webkitUnlockOrientation?screen.webkitUnlockOrientation():screen.mozUnlockOrientation?screen.mozUnlockOrientation():screen.msUnlockOrientation&&screen.msUnlockOrientation()}catch(a){}}],
["navigate",a=>{var d=a.type;if("back"===d)navigator.app&&navigator.app.backHistory?navigator.app.backHistory():window.history.back();else if("forward"===d)window.history.forward();else if("reload"===d)location.reload();else if("url"===d){d=a.url;const g=a.target;a=a.exportType;self.cordova&&self.cordova.InAppBrowser?self.cordova.InAppBrowser.open(d,"_system"):"preview"===a||"windows-webview2"===a?window.open(d,"_blank"):this.An||(2===g?window.top.location=d:1===g?window.parent.location=d:window.location=
d)}else"new-window"===d&&(d=a.url,a=a.tag,self.cordova&&self.cordova.InAppBrowser?self.cordova.InAppBrowser.open(d,"_system"):window.open(d,a))}],["request-fullscreen",a=>{if("windows-webview2"===this.K||"macos-wkwebview"===this.K)self.Ua.Wd(!0),this.L.Df({type:"set-fullscreen",fullscreen:!0});else{const d={navigationUI:"auto"};a=a.navUI;1===a?d.navigationUI="hide":2===a&&(d.navigationUI="show");a=document.documentElement;a.requestFullscreen?a.requestFullscreen(d):a.mozRequestFullScreen?a.mozRequestFullScreen(d):
a.msRequestFullscreen?a.msRequestFullscreen(d):a.webkitRequestFullScreen&&("undefined"!==typeof Element.ALLOW_KEYBOARD_INPUT?a.webkitRequestFullScreen(Element.ALLOW_KEYBOARD_INPUT):a.webkitRequestFullScreen())}}],["exit-fullscreen",()=>{"windows-webview2"===this.K||"macos-wkwebview"===this.K?(self.Ua.Wd(!1),this.L.Df({type:"set-fullscreen",fullscreen:!1})):document.exitFullscreen?document.exitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.msExitFullscreen?document.msExitFullscreen():
document.webkitCancelFullScreen&&document.webkitCancelFullScreen()}],["set-hash",a=>{location.hash=a.hash}]]);window.addEventListener("online",()=>{B(this,"online-state",{isOnline:!0})});window.addEventListener("offline",()=>{B(this,"online-state",{isOnline:!1})});window.addEventListener("hashchange",()=>{B(this,"hashchange",{location:location.toString()})});document.addEventListener("backbutton",()=>{B(this,"backbutton")})}sf(k){alert(k.message)}uf(){navigator.app&&navigator.app.exitApp?navigator.app.exitApp():
navigator.device&&navigator.device.exitApp?navigator.device.exitApp():window.close()}zf(k){k=k.isFocus;if("nwjs"===this.K){const a="nwjs"===this.K?nw.Window.get():null;k?a.focus():a.blur()}else k?window.focus():window.blur()}});"use strict";
{const k=180/Math.PI;self.ib=class extends self.zb{constructor(a){super(a,"audio");this.de=this.j=null;this.he=this.Sf=!1;this.Kb=()=>this.Hm();this.$a=[];this.ea=[];this.pb=null;this.Dh="";this.Gh=-1;this.od=new Map;this.ag=1;this.Gb=!1;this.mg=0;this.Ae=1;this.Of=0;this.Lh="HRTF";this.uh="inverse";this.Nh=600;this.Kh=1E4;this.Ph=1;this.xh=this.gg=!1;this.Sh=this.L.lj();this.ab=new Map;this.kc=new Set;this.Wf=!1;this.bg="";this.bc=null;self.C3Audio_OnMicrophoneStream=(d,g)=>this.ul(d,g);this.ce=
null;self.C3Audio_GetOutputStream=()=>this.kl();self.C3Audio_DOMInterface=this;M(this,[["create-audio-context",d=>this.Ak(d)],["play",d=>this.$l(d)],["stop",d=>this.Em(d)],["stop-all",()=>this.Fm()],["set-paused",d=>this.xm(d)],["set-volume",d=>this.Cm(d)],["fade-volume",d=>this.Hk(d)],["set-master-volume",d=>this.vm(d)],["set-muted",d=>this.wm(d)],["set-silent",d=>this.zm(d)],["set-looping",d=>this.um(d)],["set-playback-rate",d=>this.ym(d)],["seek",d=>this.hm(d)],["preload",d=>this.am(d)],["unload",
d=>this.Im(d)],["unload-all",()=>this.Jm()],["set-suspended",d=>this.Am(d)],["get-suspended",()=>this.Ok()],["add-effect",d=>this.Ug(d)],["set-effect-param",d=>this.nm(d)],["remove-effects",d=>this.cm(d)],["tick",d=>this.Vl(d)],["load-state",d=>this.rl(d)]])}async Ak(a){a.isiOSCordova&&(this.gg=!0);this.mg=a.timeScaleMode;this.Lh=["equalpower","HRTF","soundfield"][a.panningModel];this.uh=["linear","inverse","exponential"][a.distanceModel];this.Nh=a.refDistance;this.Kh=a.maxDistance;this.Ph=a.rolloffFactor;
var d={latencyHint:a.latencyHint};this.Sh||(d.sampleRate=48E3);if("undefined"!==typeof AudioContext)this.j=new AudioContext(d);else if("undefined"!==typeof webkitAudioContext)this.j=new webkitAudioContext(d);else throw Error("Web Audio API not supported");this.Vg();this.j.onstatechange=()=>{"running"!==this.j.state&&this.Vg()};this.de=this.j.createGain();this.de.connect(this.j.destination);d=a.listenerPos;this.j.listener.setPosition(d[0],d[1],d[2]);this.j.listener.setOrientation(0,0,1,0,-1,0);self.C3_GetAudioContextCurrentTime=
()=>this.Me();try{await Promise.all(a.preloadList.map(g=>this.Rd(g.originalUrl,g.url,g.type,!1)))}catch(g){console.error("[Construct 3] Preloading sounds failed: ",g)}return{sampleRate:this.j.sampleRate}}Vg(){this.he||(this.Sf=!1,window.addEventListener("pointerup",this.Kb,!0),window.addEventListener("touchend",this.Kb,!0),window.addEventListener("click",this.Kb,!0),window.addEventListener("keydown",this.Kb,!0),this.he=!0)}Ck(){this.he&&(this.Sf=!0,window.removeEventListener("pointerup",this.Kb,!0),
window.removeEventListener("touchend",this.Kb,!0),window.removeEventListener("click",this.Kb,!0),window.removeEventListener("keydown",this.Kb,!0),this.he=!1)}Hm(){if(!this.Sf){var a=this.j;"suspended"===a.state&&a.resume&&a.resume();var d=a.createBuffer(1,220,22050),g=a.createBufferSource();g.buffer=d;g.connect(a.destination);g.start(0);"running"===a.state&&this.Ck()}}Ga(){return this.j}Me(){return this.j.currentTime}Ob(){return this.de}Dg(a){return(a=this.ab.get(a.toLowerCase()))?a[0].ua():this.Ob()}di(a,
d){a=a.toLowerCase();let g=this.ab.get(a);g||(g=[],this.ab.set(a,g));d.rm(g.length);d.Bm(a);g.push(d);this.kh(a)}kh(a){let d=this.Ob();const g=this.ab.get(a);if(g&&g.length){d=g[0].ua();for(let n=0,t=g.length;n<t;++n){const h=g[n];n+1===t?h.Aa(this.Ob()):h.Aa(g[n+1].ua())}}for(const n of this.xb(a))n.Ej(d);this.bc&&this.bg===a&&(this.bc.disconnect(),this.bc.connect(d))}Ed(){return this.ag}Kd(){return this.Gb}pm(){this.xh=!0}Ki(a,d){return d?this.L.Km(a).then(g=>{const n=this.j.createBuffer(1,g.length,
48E3);n.getChannelData(0).set(g);return n}):new Promise((g,n)=>{this.j.decodeAudioData(a,g,n)})}Rb(a){this.L.Rb(a)}hc(a){this.L.hc(a)}Kg(a){let d=0;for(let g=0,n=this.ea.length;g<n;++g){const t=this.ea[g];this.ea[d]=t;t.qa===a?t.o():++d}this.ea.length=d}Fj(){let a=0;for(let d=0,g=this.$a.length;d<g;++d){const n=this.$a[d];this.$a[a]=n;n.Pb()?n.o():++a}this.$a.length=a}*xb(a){if(a)for(const d of this.ea)self.ib.Li(d.ja,a)&&(yield d);else this.pb&&!this.pb.Ba()&&(yield this.pb)}async Rd(a,d,g,n,t){for(const h of this.$a)if(h.Cc()===
d)return await h.Ja(),h;if(t)return null;n&&(this.gg||this.xh)&&this.Fj();t="audio/webm; codecs=opus"===g&&!this.Sh;n&&t&&this.pm();a=!n||this.gg||t?new self.Fi(this,a,d,g,n,t):new self.xi(this,a,d,g,n);this.$a.push(a);await a.Ja();return a}async lf(a,d,g,n,t){for(const h of this.ea)if(h.Cc()===d&&(h.Je()||t))return h.Uj(n),h;a=await this.Rd(a,d,g,t);n="html5"===a.Ef?new self.yi(a.B,a,n):new self.Gi(a.B,a,n);this.ea.push(n);return n}qk(a){let d=this.od.get(a);if(!d){let g=null;d={qg:0,en:new Promise(n=>
g=n),resolve:g};this.od.set(a,d)}d.qg++}em(a){const d=this.od.get(a);if(!d)throw Error("expected pending tag");d.qg--;0===d.qg&&(d.resolve(),this.od.delete(a))}ef(a){a||(a=this.Dh);return(a=this.od.get(a))?a.en:Promise.resolve()}Sd(){if(0<this.kc.size)N(this);else for(const a of this.ea)if(a.Fg()){N(this);break}}va(){for(var a of this.kc)a.va();a=this.Me();for(var d of this.ea)d.va(a);d=this.ea.filter(g=>g.Fg()).map(g=>g.Bc());B(this,"state",{tickCount:this.Gh,audioInstances:d,analysers:[...this.kc].map(g=>
g.Ti())});0===d.length&&0===this.kc.size&&this.ie&&(this.L.fm(this.Th),this.ie=!1)}Ue(a,d,g){B(this,"trigger",{type:a,tag:d,aiid:g})}async $l(a){const d=a.originalUrl,g=a.url,n=a.type,t=a.isMusic,h=a.tag,c=a.isLooping,f=a.vol,b=a.pos,e=a.panning;let p=a.off;0<p&&!a.trueClock&&(this.j.getOutputTimestamp?(a=this.j.getOutputTimestamp(),p=p-a.performanceTime/1E3+a.contextTime):p=p-performance.now()/1E3+this.j.currentTime);this.Dh=h;this.qk(h);try{this.pb=await this.lf(d,g,n,h,t),e?(this.pb.Nd(!0),this.pb.Sj(e.x,
e.y,e.angle,e.innerAngle,e.outerAngle,e.outerGain),e.hasOwnProperty("uid")&&this.pb.Vj(e.uid)):this.pb.Nd(!1),this.pb.Play(c,f,b,p)}catch(r){console.error("[Construct 3] Audio: error starting playback: ",r);return}finally{this.em(h)}N(this)}Em(a){a=a.tag;for(const d of this.xb(a))d.Eb()}Fm(){for(const a of this.ea)a.Eb()}xm(a){const d=a.tag;a=a.paused;for(const g of this.xb(d))a?g.Gc():g.Md();this.Sd()}Cm(a){const d=a.tag;a=a.vol;for(const g of this.xb(d))g.Pd(a)}async Hk(a){const d=a.tag,g=a.vol,
n=a.duration;a=a.stopOnEnd;await this.ef(d);for(const t of this.xb(d))t.Mi(g,n,a);this.Sd()}vm(a){this.ag=a.vol;for(const d of this.ea)d.Yd()}wm(a){const d=a.tag;a=a.isMuted;for(const g of this.xb(d))g.Og(a)}zm(a){this.Gb=a.isSilent;this.L.Od(this.Gb);for(const d of this.ea)d.Xd()}um(a){const d=a.tag;a=a.isLooping;for(const g of this.xb(d))g.af(a)}async ym(a){const d=a.tag;a=a.rate;await this.ef(d);for(const g of this.xb(d))g.Qg(a)}async hm(a){const d=a.tag;a=a.pos;await this.ef(d);for(const g of this.xb(d))g.Ze(a)}async am(a){const d=
a.originalUrl,g=a.url,n=a.type;a=a.isMusic;try{await this.lf(d,g,n,"",a)}catch(t){console.error("[Construct 3] Audio: error preloading: ",t)}}async Im(a){if(a=await this.Rd("",a.url,a.type,a.isMusic,!0))a.o(),a=this.$a.indexOf(a),-1!==a&&this.$a.splice(a,1)}Jm(){for(const a of this.$a)a.o();this.$a.length=0}Am(a){a=a.isSuspended;!a&&this.j.resume&&this.j.resume();for(const d of this.ea)d.bf(a);a&&this.j.suspend&&this.j.suspend()}Ok(){return this.j?this.j.state:"suspended"}Vl(a){this.Ae=a.timeScale;
this.Of=a.gameTime;this.Gh=a.tickCount;if(0!==this.mg)for(var d of this.ea)d.jc();(d=a.listenerPos)&&this.j.listener.setPosition(d[0],d[1],d[2]);for(const g of a.instPans){a=g.uid;for(const n of this.ea)n.ob===a&&n.Pg(g.x,g.y,g.angle)}}async Ug(a){var d=a.type;const g=a.tag;var n=a.params;if("filter"===d)n=new self.ni(this,...n);else if("delay"===d)n=new self.li(this,...n);else if("convolution"===d){d=null;try{d=await this.Rd(a.bufferOriginalUrl,a.bufferUrl,a.bufferType,!1)}catch(t){console.log("[Construct 3] Audio: error loading convolution: ",
t);return}n=new self.ki(this,d.Za,...n);n.lm(a.bufferOriginalUrl,a.bufferType)}else if("flanger"===d)n=new self.oi(this,...n);else if("phaser"===d)n=new self.ri(this,...n);else if("gain"===d)n=new self.pi(this,...n);else if("tremolo"===d)n=new self.ti(this,...n);else if("ringmod"===d)n=new self.si(this,...n);else if("distortion"===d)n=new self.mi(this,...n);else if("compressor"===d)n=new self.ji(this,...n);else if("analyser"===d)n=new self.ii(this,...n);else throw Error("invalid effect type");this.di(g,
n);this.jh()}nm(a){const d=a.index,g=a.param,n=a.value,t=a.ramp,h=a.time;a=this.ab.get(a.tag);!a||0>d||d>=a.length||(a[d].Ma(g,n,t,h),this.jh())}cm(a){a=a.tag.toLowerCase();const d=this.ab.get(a);if(d&&d.length){for(const g of d)g.o();this.ab.delete(a);this.kh(a)}}lk(a){this.kc.add(a);this.Sd()}bm(a){this.kc.delete(a)}jh(){this.Wf||(this.Wf=!0,Promise.resolve().then(()=>this.Ek()))}Ek(){const a={};for(const [d,g]of this.ab)a[d]=g.map(n=>n.Bc());B(this,"fxstate",{fxstate:a});this.Wf=!1}async rl(a){const d=
a.saveLoadMode;if(3!==d)for(var g of this.ea)g.Pb()&&1===d||(g.Pb()||2!==d)&&g.Eb();for(const n of this.ab.values())for(const t of n)t.o();this.ab.clear();this.Ae=a.timeScale;this.Of=a.gameTime;g=a.listenerPos;this.j.listener.setPosition(g[0],g[1],g[2]);this.Gb=a.isSilent;this.L.Od(this.Gb);this.ag=a.masterVolume;g=[];for(const n of Object.values(a.effects))g.push(Promise.all(n.map(t=>this.Ug(t))));await Promise.all(g);await Promise.all(a.playing.map(n=>this.Uk(n,d)));this.Sd()}async Uk(a,d){if(3!==
d){var g=a.bufferOriginalUrl,n=a.bufferUrl,t=a.bufferType,h=a.isMusic,c=a.tag,f=a.isLooping,b=a.volume,e=a.playbackTime;if(!h||1!==d)if(h||2!==d){d=null;try{d=await this.lf(g,n,t,c,h)}catch(p){console.error("[Construct 3] Audio: error loading audio state: ",p);return}d.rj(a.pan);d.Play(f,b,e,0);a.isPlaying||d.Gc();d.qf(a)}}}ul(a,d){this.bc&&this.bc.disconnect();this.bg=d.toLowerCase();this.bc=this.j.createMediaStreamSource(a);this.bc.connect(this.Dg(this.bg))}kl(){this.ce||(this.ce=this.j.createMediaStreamDestination(),
this.de.connect(this.ce));return this.ce.stream}static Li(a,d){return a.length!==d.length?!1:a===d?!0:a.toLowerCase()===d.toLowerCase()}static kk(a){return a*k}static Ji(a){return Math.pow(10,a/20)}static Bg(a){return Math.max(Math.min(self.ib.Ji(a),1),0)}static qj(a){return Math.log(a)/Math.log(10)*20}static pj(a){return self.ib.qj(Math.max(Math.min(a,1),0))}static Ym(a,d){return 1-Math.exp(-d*a)}};self.Ua.Lb(self.ib)}"use strict";
self.vg=class{constructor(k,a,d,g,n){this.B=k;this.Rm=a;this.dc=d;this.za=g;this.Nm=n;this.Ef="";this.s=null}o(){this.s=this.B=null}pf(){}Ja(){this.s||(this.s=this.pf());return this.s}Ga(){return this.B.Ga()}Oe(){return this.Rm}Cc(){return this.dc}Ne(){return this.za}Pb(){return this.Nm}kb(){}};"use strict";
self.xi=class extends self.vg{constructor(k,a,d,g,n){super(k,a,d,g,n);this.Ef="html5";this.la=new Audio;this.la.crossOrigin="anonymous";this.la.autoplay=!1;this.la.preload="auto";this.dd=this.ed=null;this.la.addEventListener("canplaythrough",()=>!0);this.md=this.Ga().createGain();this.gd=null;this.la.addEventListener("canplay",()=>{this.ed&&(this.ed(),this.dd=this.ed=null);!this.gd&&this.la&&(this.gd=this.Ga().createMediaElementSource(this.la),this.gd.connect(this.md))});this.onended=null;this.la.addEventListener("ended",
()=>{if(this.onended)this.onended()});this.la.addEventListener("error",t=>{console.error(`[Construct 3] Audio '${this.dc}' error: `,t);this.dd&&(this.dd(t),this.dd=this.ed=null)})}o(){this.B.Kg(this);this.md.disconnect();this.md=null;this.gd.disconnect();this.gd=null;this.la&&!this.la.paused&&this.la.pause();this.la=this.onended=null;super.o()}pf(){return new Promise((k,a)=>{this.ed=k;this.dd=a;this.la.src=this.dc})}ta(){return this.la}kb(){return this.la.duration}};"use strict";
async function Y(k){if(k.Vb)return k.Vb;var a=k.B.L;if("cordova"===a.K&&a.Ig(k.dc)&&a.Yc)k.Vb=await a.Bd(k.dc);else{a=await fetch(k.dc);if(!a.ok)throw Error(`error fetching audio data: ${a.status} ${a.statusText}`);k.Vb=await a.arrayBuffer()}}async function aa(k){if(k.Za)return k.Za;k.Za=await k.B.Ki(k.Vb,k.Pm);k.Vb=null}
self.Fi=class extends self.vg{constructor(k,a,d,g,n,t){super(k,a,d,g,n);this.Ef="webaudio";this.Za=this.Vb=null;this.Pm=!!t}o(){this.B.Kg(this);this.Za=this.Vb=null;super.o()}async pf(){try{await Y(this),await aa(this)}catch(k){console.error(`[Construct 3] Failed to load audio '${this.dc}': `,k)}}kb(){return this.Za?this.Za.duration:0}};"use strict";
{let k=0;self.wg=class{constructor(a,d,g){this.B=a;this.qa=d;this.ja=g;this.Zd=k++;this.ra=this.Ga().createGain();this.ra.connect(this.Ob());this.V=null;this.$c=!1;this.sb=[0,0,0];this.rb=[0,0,0];this.ha=!0;this.Da=this.ub=this.ga=!1;this.wd=1;this.oc=!1;this.Ib=1;a=this.B.mg;this.Xf=1===a&&!this.Pb()||2===a;this.Sc=this.ob=-1;this.Rh=!1}o(){this.qa=this.B=null;this.V&&(this.V.disconnect(),this.V=null);this.ra.disconnect();this.ra=null}Ga(){return this.B.Ga()}Ob(){return this.B.Dg(this.ja)}Ed(){return this.B.Ed()}Dd(){return this.Xf?
this.B.Of:performance.now()/1E3}Oe(){return this.qa.Oe()}Cc(){return this.qa.Cc()}Ne(){return this.qa.Ne()}Pb(){return this.qa.Pb()}Uj(a){this.ja=a}Ba(){}Je(){}IsPlaying(){return!this.ha&&!this.ga&&!this.Ba()}Fg(){return!this.ha&&!this.Ba()}ec(){}kb(){return this.qa.kb()}Play(){}Eb(){}Gc(){}Md(){}Pd(a){this.wd=a;this.ra.gain.cancelScheduledValues(0);this.Sc=-1;this.ra.gain.value=this.Pe()}Mi(a,d,g){if(!this.oc){a*=this.Ed();var n=this.ra.gain;n.cancelScheduledValues(0);var t=this.B.Me();d=t+d;n.setValueAtTime(n.value,
t);n.linearRampToValueAtTime(a,d);this.wd=a;this.Sc=d;this.Rh=g}}Yd(){this.Pd(this.wd)}va(a){-1!==this.Sc&&a>=this.Sc&&(this.Sc=-1,this.Rh&&this.Eb(),this.B.Ue("fade-ended",this.ja,this.Zd))}Pe(){const a=this.wd*this.Ed();return isFinite(a)?a:0}Og(a){a=!!a;this.oc!==a&&(this.oc=a,this.Xd())}Kd(){return this.B.Kd()}Xd(){}af(){}Qg(a){this.Ib!==a&&(this.Ib=a,this.jc())}jc(){}Ze(){}bf(){}Nd(a){a=!!a;this.$c!==a&&((this.$c=a)?(this.V||(this.V=this.Ga().createPanner(),this.V.panningModel=this.B.Lh,this.V.distanceModel=
this.B.uh,this.V.refDistance=this.B.Nh,this.V.maxDistance=this.B.Kh,this.V.rolloffFactor=this.B.Ph),this.ra.disconnect(),this.ra.connect(this.V),this.V.connect(this.Ob())):(this.V.disconnect(),this.ra.disconnect(),this.ra.connect(this.Ob())))}Sj(a,d,g,n,t,h){this.$c&&(this.Pg(a,d,g),a=self.ib.kk,this.V.coneInnerAngle=a(n),this.V.coneOuterAngle=a(t),this.V.coneOuterGain=h)}Pg(a,d,g){this.$c&&(this.sb[0]=a,this.sb[1]=d,this.sb[2]=0,this.rb[0]=Math.cos(g),this.rb[1]=Math.sin(g),this.rb[2]=0,this.V.setPosition(...this.sb),
this.V.setOrientation(...this.rb))}Vj(a){this.ob=a}Qe(){}Ej(a){const d=this.V||this.ra;d.disconnect();d.connect(a)}Bc(){return{aiid:this.Zd,tag:this.ja,duration:this.kb(),volume:this.wd,isPlaying:this.IsPlaying(),playbackTime:this.ec(),playbackRate:this.Ib,uid:this.ob,bufferOriginalUrl:this.Oe(),bufferUrl:"",bufferType:this.Ne(),isMusic:this.Pb(),isLooping:this.Da,isMuted:this.oc,resumePosition:this.Qe(),pan:this.aj()}}qf(a){this.Qg(a.playbackRate);this.Og(a.isMuted)}aj(){if(!this.V)return null;const a=
this.V;return{pos:this.sb,orient:this.rb,cia:a.coneInnerAngle,coa:a.coneOuterAngle,cog:a.coneOuterGain,uid:this.ob}}rj(a){if(a){this.Nd(!0);a=this.V;var d=a.pos;this.sb[0]=d[0];this.sb[1]=d[1];this.sb[2]=d[2];d=a.orient;this.rb[0]=d[0];this.rb[1]=d[1];this.rb[2]=d[2];a.setPosition(...this.sb);a.setOrientation(...this.rb);a.coneInnerAngle=a.cia;a.coneOuterAngle=a.coa;a.coneOuterGain=a.cog;this.ob=a.uid}else this.Nd(!1)}}}"use strict";
self.yi=class extends self.wg{constructor(k,a,d){super(k,a,d);this.qa.md.connect(this.ra);this.qa.onended=()=>this.vf()}o(){this.Eb();this.qa.md.disconnect();super.o()}ta(){return this.qa.ta()}vf(){this.ha=!0;this.ob=-1;this.B.Ue("ended",this.ja,this.Zd)}Ba(){return this.ta().ended}Je(){return this.ha?!0:this.Ba()}ec(){let k=this.ta().currentTime;this.Da||(k=Math.min(k,this.kb()));return k}Play(k,a,d){const g=this.ta();1!==g.playbackRate&&(g.playbackRate=1);g.loop!==k&&(g.loop=k);this.Pd(a);g.muted&&
(g.muted=!1);if(g.currentTime!==d)try{g.currentTime=d}catch(n){console.warn(`[Construct 3] Exception seeking audio '${this.qa.Cc()}' to position '${d}': `,n)}this.B.Rb(g);this.ga=this.ha=!1;this.Da=k;this.Ib=1}Eb(){const k=this.ta();k.paused||k.pause();this.B.hc(k);this.ha=!0;this.ga=!1;this.ob=-1}Gc(){if(!(this.ga||this.ha||this.Ba())){var k=this.ta();k.paused||k.pause();this.B.hc(k);this.ga=!0}}Md(){!this.ga||this.ha||this.Ba()||(this.B.Rb(this.ta()),this.ga=!1)}Xd(){this.ta().muted=this.oc||this.Kd()}af(k){k=
!!k;this.Da!==k&&(this.Da=k,this.ta().loop=k)}jc(){let k=this.Ib;this.Xf&&(k*=this.B.Ae);try{this.ta().playbackRate=k}catch(a){console.warn(`[Construct 3] Unable to set playback rate '${k}':`,a)}}Ze(k){if(!this.ha&&!this.Ba())try{this.ta().currentTime=k}catch(a){console.warn(`[Construct 3] Error seeking audio to '${k}': `,a)}}Qe(){return this.ec()}bf(k){k?this.IsPlaying()?(this.ta().pause(),this.ub=!0):this.ub=!1:this.ub&&(this.B.Rb(this.ta()),this.ub=!1)}};"use strict";
function Z(k){k.C&&k.C.disconnect();k.C=null;k.Mc=null}
self.Gi=class extends self.wg{constructor(k,a,d){super(k,a,d);this.C=null;this.qe=g=>this.vf(g);this.Rf=!0;this.Mc=null;this.sa=this.re=this.se=0;this.cg=1}o(){this.Eb();Z(this);this.qe=null;super.o()}vf(k){this.ga||this.ub||k.target!==this.Mc||(this.ha=this.Rf=!0,this.ob=-1,Z(this),this.B.Ue("ended",this.ja,this.Zd))}Ba(){return!this.ha&&this.C&&this.C.loop||this.ga?!1:this.Rf}Je(){return!this.C||this.ha?!0:this.Ba()}ec(){let k;k=this.ga?this.sa:this.re+(this.Dd()-this.se)*this.Ib;this.Da||(k=Math.min(k,
this.kb()));return k}Play(k,a,d,g){this.cg=1;this.Pd(a);Z(this);this.C=this.Ga().createBufferSource();this.C.buffer=this.qa.Za;this.C.connect(this.ra);this.Mc=this.C;this.C.onended=this.qe;this.C.loop=k;this.C.start(g,d);this.ga=this.ha=this.Rf=!1;this.Da=k;this.Ib=1;this.se=this.Dd();this.re=d}Eb(){if(this.C)try{this.C.stop(0)}catch(k){}this.ha=!0;this.ga=!1;this.ob=-1}Gc(){this.ga||this.ha||this.Ba()||(this.sa=this.ec(),this.Da&&(this.sa%=this.kb()),this.ga=!0,this.C.stop(0))}Md(){!this.ga||this.ha||
this.Ba()||(Z(this),this.C=this.Ga().createBufferSource(),this.C.buffer=this.qa.Za,this.C.connect(this.ra),this.Mc=this.C,this.C.onended=this.qe,this.C.loop=this.Da,this.Yd(),this.jc(),this.C.start(0,this.sa),this.se=this.Dd(),this.re=this.sa,this.ga=!1)}Pe(){return super.Pe()*this.cg}Xd(){this.cg=this.oc||this.Kd()?0:1;this.Yd()}af(k){k=!!k;this.Da!==k&&(this.Da=k,this.C&&(this.C.loop=k))}jc(){let k=this.Ib;this.Xf&&(k*=this.B.Ae);this.C&&(this.C.playbackRate.value=k)}Ze(k){this.ha||this.Ba()||(this.ga?
this.sa=k:(this.Gc(),this.sa=k,this.Md()))}Qe(){return this.sa}bf(k){k?this.IsPlaying()?(this.ub=!0,this.sa=this.ec(),this.Da&&(this.sa%=this.kb()),this.C.stop(0)):this.ub=!1:this.ub&&(Z(this),this.C=this.Ga().createBufferSource(),this.C.buffer=this.qa.Za,this.C.connect(this.ra),this.Mc=this.C,this.C.onended=this.qe,this.C.loop=this.Da,this.Yd(),this.jc(),this.C.start(0,this.sa),this.se=this.Dd(),this.re=this.sa,this.ub=!1)}qf(k){super.qf(k);this.sa=k.resumePosition}};"use strict";
{class k{constructor(a){this.B=a;this.j=a.Ga();this.Wc=-1;this.za=this.ja="";this.v=null}o(){this.j=null}rm(a){this.Wc=a}Bm(a){this.ja=a}H(){return this.j.createGain()}ua(){}Aa(){}G(a,d,g,n){a.cancelScheduledValues(0);if(0===n)a.value=d;else{var t=this.j.currentTime;n+=t;switch(g){case 0:a.setValueAtTime(d,n);break;case 1:a.setValueAtTime(a.value,t);a.linearRampToValueAtTime(d,n);break;case 2:a.setValueAtTime(a.value,t),a.exponentialRampToValueAtTime(d,n)}}}Bc(){return{type:this.za,tag:this.ja,params:this.v}}}
self.ni=class extends k{constructor(a,d,g,n,t,h,c){super(a);this.za="filter";this.v=[d,g,n,t,h,c];this.F=this.H();this.h=this.H();this.h.gain.value=c;this.g=this.H();this.g.gain.value=1-c;this.R=this.j.createBiquadFilter();this.R.type=d;this.R.frequency.value=g;this.R.detune.value=n;this.R.Q.value=t;this.R.gain.vlaue=h;this.F.connect(this.R);this.F.connect(this.g);this.R.connect(this.h)}o(){this.F.disconnect();this.R.disconnect();this.h.disconnect();this.g.disconnect();super.o()}Aa(a){this.h.disconnect();
this.h.connect(a);this.g.disconnect();this.g.connect(a)}ua(){return this.F}Ma(a,d,g,n){switch(a){case 0:d=Math.max(Math.min(d/100,1),0);this.v[5]=d;this.G(this.h.gain,d,g,n);this.G(this.g.gain,1-d,g,n);break;case 1:this.v[1]=d;this.G(this.R.frequency,d,g,n);break;case 2:this.v[2]=d;this.G(this.R.detune,d,g,n);break;case 3:this.v[3]=d;this.G(this.R.Q,d,g,n);break;case 4:this.v[4]=d,this.G(this.R.gain,d,g,n)}}};self.li=class extends k{constructor(a,d,g,n){super(a);this.za="delay";this.v=[d,g,n];this.F=
this.H();this.h=this.H();this.h.gain.value=n;this.g=this.H();this.g.gain.value=1-n;this.fd=this.H();this.Ca=this.j.createDelay(d);this.Ca.delayTime.value=d;this.Rc=this.H();this.Rc.gain.value=g;this.F.connect(this.fd);this.F.connect(this.g);this.fd.connect(this.h);this.fd.connect(this.Ca);this.Ca.connect(this.Rc);this.Rc.connect(this.fd)}o(){this.F.disconnect();this.h.disconnect();this.g.disconnect();this.fd.disconnect();this.Ca.disconnect();this.Rc.disconnect();super.o()}Aa(a){this.h.disconnect();
this.h.connect(a);this.g.disconnect();this.g.connect(a)}ua(){return this.F}Ma(a,d,g,n){const t=self.ib.Bg;switch(a){case 0:d=Math.max(Math.min(d/100,1),0);this.v[2]=d;this.G(this.h.gain,d,g,n);this.G(this.g.gain,1-d,g,n);break;case 4:this.v[1]=t(d);this.G(this.Rc.gain,t(d),g,n);break;case 5:this.v[0]=d,this.G(this.Ca.delayTime,d,g,n)}}};self.ki=class extends k{constructor(a,d,g,n){super(a);this.za="convolution";this.v=[g,n];this.qh=this.ph="";this.F=this.H();this.h=this.H();this.h.gain.value=n;this.g=
this.H();this.g.gain.value=1-n;this.Pc=this.j.createConvolver();this.Pc.normalize=g;this.Pc.buffer=d;this.F.connect(this.Pc);this.F.connect(this.g);this.Pc.connect(this.h)}o(){this.F.disconnect();this.Pc.disconnect();this.h.disconnect();this.g.disconnect();super.o()}Aa(a){this.h.disconnect();this.h.connect(a);this.g.disconnect();this.g.connect(a)}ua(){return this.F}Ma(a,d,g,n){switch(a){case 0:d=Math.max(Math.min(d/100,1),0),this.v[1]=d,this.G(this.h.gain,d,g,n),this.G(this.g.gain,1-d,g,n)}}lm(a,
d){this.ph=a;this.qh=d}Bc(){const a=super.Bc();a.bufferOriginalUrl=this.ph;a.bufferUrl="";a.bufferType=this.qh;return a}};self.oi=class extends k{constructor(a,d,g,n,t,h){super(a);this.za="flanger";this.v=[d,g,n,t,h];this.F=this.H();this.g=this.H();this.g.gain.value=1-h/2;this.h=this.H();this.h.gain.value=h/2;this.Tc=this.H();this.Tc.gain.value=t;this.Ca=this.j.createDelay(d+g);this.Ca.delayTime.value=d;this.N=this.j.createOscillator();this.N.frequency.value=n;this.ia=this.H();this.ia.gain.value=
g;this.F.connect(this.Ca);this.F.connect(this.g);this.Ca.connect(this.h);this.Ca.connect(this.Tc);this.Tc.connect(this.Ca);this.N.connect(this.ia);this.ia.connect(this.Ca.delayTime);this.N.start(0)}o(){this.N.stop(0);this.F.disconnect();this.Ca.disconnect();this.N.disconnect();this.ia.disconnect();this.g.disconnect();this.h.disconnect();this.Tc.disconnect();super.o()}Aa(a){this.h.disconnect();this.h.connect(a);this.g.disconnect();this.g.connect(a)}ua(){return this.F}Ma(a,d,g,n){switch(a){case 0:d=
Math.max(Math.min(d/100,1),0);this.v[4]=d;this.G(this.h.gain,d/2,g,n);this.G(this.g.gain,1-d/2,g,n);break;case 6:this.v[1]=d/1E3;this.G(this.ia.gain,d/1E3,g,n);break;case 7:this.v[2]=d;this.G(this.N.frequency,d,g,n);break;case 8:this.v[3]=d/100,this.G(this.Tc.gain,d/100,g,n)}}};self.ri=class extends k{constructor(a,d,g,n,t,h,c){super(a);this.za="phaser";this.v=[d,g,n,t,h,c];this.F=this.H();this.g=this.H();this.g.gain.value=1-c/2;this.h=this.H();this.h.gain.value=c/2;this.R=this.j.createBiquadFilter();
this.R.type="allpass";this.R.frequency.value=d;this.R.detune.value=g;this.R.Q.value=n;this.N=this.j.createOscillator();this.N.frequency.value=h;this.ia=this.H();this.ia.gain.value=t;this.F.connect(this.R);this.F.connect(this.g);this.R.connect(this.h);this.N.connect(this.ia);this.ia.connect(this.R.frequency);this.N.start(0)}o(){this.N.stop(0);this.F.disconnect();this.R.disconnect();this.N.disconnect();this.ia.disconnect();this.g.disconnect();this.h.disconnect();super.o()}Aa(a){this.h.disconnect();
this.h.connect(a);this.g.disconnect();this.g.connect(a)}ua(){return this.F}Ma(a,d,g,n){switch(a){case 0:d=Math.max(Math.min(d/100,1),0);this.v[5]=d;this.G(this.h.gain,d/2,g,n);this.G(this.g.gain,1-d/2,g,n);break;case 1:this.v[0]=d;this.G(this.R.frequency,d,g,n);break;case 2:this.v[1]=d;this.G(this.R.detune,d,g,n);break;case 3:this.v[2]=d;this.G(this.R.Q,d,g,n);break;case 6:this.v[3]=d;this.G(this.ia.gain,d,g,n);break;case 7:this.v[4]=d,this.G(this.N.frequency,d,g,n)}}};self.pi=class extends k{constructor(a,
d){super(a);this.za="gain";this.v=[d];this.A=this.H();this.A.gain.value=d}o(){this.A.disconnect();super.o()}Aa(a){this.A.disconnect();this.A.connect(a)}ua(){return this.A}Ma(a,d,g,n){const t=self.ib.Bg;switch(a){case 4:this.v[0]=t(d),this.G(this.A.gain,t(d),g,n)}}};self.ti=class extends k{constructor(a,d,g){super(a);this.za="tremolo";this.v=[d,g];this.A=this.H();this.A.gain.value=1-g/2;this.N=this.j.createOscillator();this.N.frequency.value=d;this.ia=this.H();this.ia.gain.value=g/2;this.N.connect(this.ia);
this.ia.connect(this.A.gain);this.N.start(0)}o(){this.N.stop(0);this.N.disconnect();this.ia.disconnect();this.A.disconnect();super.o()}Aa(a){this.A.disconnect();this.A.connect(a)}ua(){return this.A}Ma(a,d,g,n){switch(a){case 0:d=Math.max(Math.min(d/100,1),0);this.v[1]=d;this.G(this.A.gain,1-d/2,g,n);this.G(this.ia.gain,d/2,g,n);break;case 7:this.v[0]=d,this.G(this.N.frequency,d,g,n)}}};self.si=class extends k{constructor(a,d,g){super(a);this.za="ringmod";this.v=[d,g];this.F=this.H();this.h=this.H();
this.h.gain.value=g;this.g=this.H();this.g.gain.value=1-g;this.sd=this.H();this.sd.gain.value=0;this.N=this.j.createOscillator();this.N.frequency.value=d;this.N.connect(this.sd.gain);this.N.start(0);this.F.connect(this.sd);this.F.connect(this.g);this.sd.connect(this.h)}o(){this.N.stop(0);this.N.disconnect();this.sd.disconnect();this.F.disconnect();this.h.disconnect();this.g.disconnect();super.o()}Aa(a){this.h.disconnect();this.h.connect(a);this.g.disconnect();this.g.connect(a)}ua(){return this.F}Ma(a,
d,g,n){switch(a){case 0:d=Math.max(Math.min(d/100,1),0);this.v[1]=d;this.G(this.h.gain,d,g,n);this.G(this.g.gain,1-d,g,n);break;case 7:this.v[0]=d,this.G(this.N.frequency,d,g,n)}}};self.mi=class extends k{constructor(a,d,g,n,t,h){super(a);this.za="distortion";this.v=[d,g,n,t,h];this.F=this.H();this.we=this.H();this.ve=this.H();this.mm(n,t);this.h=this.H();this.h.gain.value=h;this.g=this.H();this.g.gain.value=1-h;this.Ee=this.j.createWaveShaper();this.If=new Float32Array(65536);this.Jk(d,g);this.Ee.curve=
this.If;this.F.connect(this.we);this.F.connect(this.g);this.we.connect(this.Ee);this.Ee.connect(this.ve);this.ve.connect(this.h)}o(){this.F.disconnect();this.we.disconnect();this.Ee.disconnect();this.ve.disconnect();this.h.disconnect();this.g.disconnect();super.o()}mm(a,d){.01>a&&(a=.01);this.we.gain.value=a;this.ve.gain.value=Math.pow(1/a,.6)*d}Jk(a,d){for(let g=0;32768>g;++g){let n=g/32768;n=this.Dm(n,a,d);this.If[32768+g]=n;this.If[32768-g-1]=-n}}Dm(a,d,g){g=1.05*g*d-d;const n=0>a?-a:a;return(n<
d?n:d+g*self.ib.Ym(n-d,1/g))*(0>a?-1:1)}Aa(a){this.h.disconnect();this.h.connect(a);this.g.disconnect();this.g.connect(a)}ua(){return this.F}Ma(a,d,g,n){switch(a){case 0:d=Math.max(Math.min(d/100,1),0),this.v[4]=d,this.G(this.h.gain,d,g,n),this.G(this.g.gain,1-d,g,n)}}};self.ji=class extends k{constructor(a,d,g,n,t,h){super(a);this.za="compressor";this.v=[d,g,n,t,h];this.A=this.j.createDynamicsCompressor();this.A.threshold.value=d;this.A.knee.value=g;this.A.ratio.value=n;this.A.attack.value=t;this.A.release.value=
h}o(){this.A.disconnect();super.o()}Aa(a){this.A.disconnect();this.A.connect(a)}ua(){return this.A}Ma(){}};self.ii=class extends k{constructor(a,d,g){super(a);this.za="analyser";this.v=[d,g];this.A=this.j.createAnalyser();this.A.fftSize=d;this.A.smoothingTimeConstant=g;this.wh=new Float32Array(this.A.frequencyBinCount);this.Qh=new Uint8Array(d);this.Oh=this.tc=0;this.B.lk(this)}o(){this.B.bm(this);this.A.disconnect();super.o()}va(){this.A.getFloatFrequencyData(this.wh);this.A.getByteTimeDomainData(this.Qh);
const a=this.A.fftSize;let d=this.tc=0;for(var g=0;g<a;++g){let n=(this.Qh[g]-128)/128;0>n&&(n=-n);this.tc<n&&(this.tc=n);d+=n*n}g=self.ib.pj;this.tc=g(this.tc);this.Oh=g(Math.sqrt(d/a))}Aa(a){this.A.disconnect();this.A.connect(a)}ua(){return this.A}Ma(){}Ti(){return{tag:this.ja,index:this.Wc,peak:this.tc,rms:this.Oh,binCount:this.A.frequencyBinCount,freqBins:this.wh}}}}"use strict";
{const k=[],a=2*Math.PI;function d(c){c%=a;0>c&&(c+=a);return c}class g{constructor(c,f,b,e,p,r){this.Wc=c;this.Xc=f;this.Jb=b;this.ja=e;this.De=p;this.sh=r}fc(){return{tag:this.ja,interp:this.Xc,userData:this.De,cvt:this.sh}}Ab(){return this.Xc}gj(){return"undefined"!==typeof this.De}yg(c){switch(this.Jb){case 0:return c;case 1:return Math.fround(c);case 2:return 2===this.Xc&&(c=d(c),c/=Math.PI,c=32767*(c-1)),c|=0,-32768>c?-32768:32767<c?32767:c;case 3:return 2===this.Xc&&(c=d(c),c/=a,c*=255),c|=
0,0>c?0:255<c?255:c;default:return c}}Tg(c,f,b){switch(this.Jb){case 0:c.setFloat64(f,b);f+=8;break;case 1:c.setFloat32(f,b);f+=4;break;case 2:c.setInt16(f,b);f+=2;break;case 3:c.setUint8(f,b);f+=1;break;default:c.setFloat32(f,b),f+=4}return f}Ld(c){if(2!==this.Xc)return c;2===this.Jb?c=(c/32767+1)*Math.PI:3===this.Jb&&(c=c/255*a);return c}static Id(c,f,b,e,p){switch(c){case 0:return p?b:f;case 1:return f+e*(b-f);case 2:return f===b?c=0:(c=Math.sin(f)*Math.sin(b)+Math.cos(f)*Math.cos(b),c=1<=c?0:
-1>=c?Math.PI:Math.acos(c)),f=0>=Math.cos(b)*Math.sin(f)-Math.sin(b)*Math.cos(f)?d(f+c*e):d(f-c*e);default:return p?b:f}}}class n{constructor(c,f){this.timestamp=c;this.data=f}}class t{constructor(c,f,b){this.Fa=c;this.b=c.b;this.M=f;this.ca=b;this.Qc=[];this.Qc.length=this.Fa.Ia.length;this.$f=this.ke=0;this.yh=this.Be=!1;this.ka=[];this.S=this.D=this.Ra=null}fc(){var c=[];for(let b=0,e=this.Fa.Ia.length;b<e;++b)c.push(this.Ab(this.Fa.ze,b));c={id:this.M,nid:this.ca,isTimedOut:this.mj(),interpValues:c,
latestUpdate:null};const f=this.Wi();f&&(c.latestUpdate={timestamp:f.timestamp,data:f.data});return c}Mg(c){this.yh=!!c}gf(c,f){c=c.netValues;var b=this.Fa.Ia;const e=b.length;this.Be=!1;for(let p=0;p<e;++p){const r=b[p].yg(c[p]);this.Qc[p]!==r&&(this.Qc[p]=r,this.ke=f,this.Fa.Pj(f))}c=f-this.ke;f-=this.$f;b=this.Fa.oh;(this.Be=100>c&&0===b?!0:1E3>c&&1>=b?95<=f:495<=f)&&this.Fa.ij()}hf(c,f,b){const e=this.Fa.Ia;this.$f=b;c.setUint16(f,this.ca);f+=2;for(let p=0,r=this.Qc.length;p<r;++p)f=e[p].Tg(c,
f,this.Qc[p]);return f}Ie(c,f){for(let b=0,e=this.ka.length;b<e;++b){const p=this.ka[b];if(p.timestamp===c)return;if(p.timestamp>c){this.ka.splice(b,0,new n(c,f));return}}this.ka.push(new n(c,f))}mj(){return 0===this.ka.length?!1:this.ka[this.ka.length-1].timestamp<this.Fa.ze-3E3}va(){for(;2<this.ka.length&&this.ka[0]!==this.Ra&&this.ka[0]!==this.D&&this.ka[0]!==this.S;)this.ka.shift();const c=this.Fa.ze;if(!(this.S&&this.S.timestamp>c&&this.D&&this.D.timestamp<c)){this.S=null;for(let f=0,b=this.ka.length;f<
b;++f){const e=this.ka[f];if(e.timestamp<=c){if(!this.D||e.timestamp>this.D.timestamp)this.Ra=this.D,this.D=e}else{this.S=e;break}}}}Wi(){return 0===this.ka.length?null:this.ka[this.ka.length-1]}Ab(c,f){if(!this.S&&!this.D)return 0;if(this.S&&!this.D)return this.S.data[f];const b=this.Fa.Ia;let e,p,r;if(!this.S&&this.D){if(this.Ra){var v=this.Ra.timestamp;e=this.Ra.data[f];p=this.D.timestamp;r=this.D.data[f];c>this.D.timestamp+this.Fa.ge&&(c=this.D.timestamp+this.Fa.ge);v=v===p?0:(c-v)/(p-v);return g.Id(b[f].Ab(),
e,r,v,!0)}return this.D.data[f]}v=this.D.timestamp;e=this.D.data[f];p=this.S.timestamp;r=this.S.data[f];v=v===p?0:(c-v)/(p-v);return g.Id(b[f].Ab(),e,r,v,!1)}}class h{constructor(c,f,b,e){this.b=c;this.td=f;this.ud=b;this.ca=this.b.$i();this.oh=e;this.De={};this.cb=0;this.ge=250;switch(this.oh){case 1:this.ge=500;break;case 2:this.ge=2500}this.Ia=[];this.Qa=[];this.$b=new Map;this.zc=new Set;this.ld=this.$f=this.ke=this.jd=0;this.nc=!1;this.be=[];this.kd=new Map;this.ze=0;this.b.fi(this)}Tb(c){this.ca=
c}Pj(c){this.ke=c}ij(){this.ld++}qm(){this.nc=!0}yb(c,f,b,e,p){c=new g(this.Ia.length,c,f,b,e,p);switch(f){case 0:this.cb+=8;break;case 1:this.cb+=4;break;case 2:this.cb+=2;break;case 3:this.cb+=1}this.Ia.push(c)}Ie(c,f,b){this.Yi(f).Ie(c,b)}va(){this.ze=this.b.Gd();for(const c of this.Qa)c.va()}Zi(){const c=[];for(const f of this.Ia){const b={tag:f.ja,precision:f.Jb,interp:f.Ab(),clientvaluetag:f.sh};f.gj()&&(b.userdata=f.De);c.push(b)}return c}Rj(c){this.cb=this.Ia.length=0;for(const f of c)this.yb(f.interp,
f.precision,f.tag,f.userdata,f.clientvaluetag)}Yi(c){let f=this.kd.get(c);if(f)return f;f=new t(this,-1,c);this.kd.set(c,f);this.Qa.push(f);return f}Xi(c){let f=this.$b.get(c);if(f)return f;f=new t(this,c,this.hi());this.$b.set(c,f);this.Qa.push(f);return f}hi(){do this.jd++,65535<this.jd&&(this.jd=0);while(this.zc.has(this.jd));const c=this.jd;this.zc.add(c);return c}Ve(c){const f=c.M,b=c.ca;this.b.l()&&!this.nc&&this.be.push(b);this.$b.delete(f);this.kd.delete(b);this.zc.delete(b);c=this.Qa.indexOf(c);
-1<c&&this.Qa.splice(c,1)}Hi(){this.be.length=0;this.$b.clear();this.kd.clear();this.zc.clear();this.Qa.length=0}gf(c,f){this.ld=0;for(var b of this.Qa)b.Mg(!1);for(let e=0,p=c.length;e<p;++e){b=c[e];const r=this.Xi(b.uid);r.Mg(!0);r.gf(b,f)}for(const e of this.Qa)e.yh||k.push(e);for(const e of k)this.Ve(e);k.length=0}hf(c,f,b){c.setUint16(f,this.ca);f+=2;let e=0;this.nc&&(e=1);c.setUint8(f,e);f+=1;c.setUint16(f,this.ld);f+=2;c.setUint16(f,this.cb);f+=2;for(const p of this.Qa)p.Be&&(f=p.hf(c,f,b));
return f}Cj(c,f){if(this.$b.has(c))console.warn("OverrideNid passed id "+c+" which is already in use and cannot be overridden");else if(this.zc.has(f))console.warn("OverrideNid passed nid "+f+" which is already in use and cannot be overridden");else{var b=new t(this,c,f);this.$b.set(c,b);this.zc.add(f);this.Qa.push(b);this.nc=!0}}We(c){(c=this.$b.get(c))&&this.Ve(c)}Xe(c){(c=this.kd.get(c))&&this.Ve(c)}fc(){return{hasOverriddenNids:this.nc,netValues:this.Ia.map(c=>c.fc()),netInstances:this.Qa.map(c=>
c.fc())}}cj(){return{roId:this.td,sid:this.ud,netValues:this.Ia.map(c=>c.fc())}}}self.xg=g;self.Ai=n;self.Ci=h}"use strict";
{const k=self.Ai,a=self.xg,d=window.RTCPeerConnection||window.webkitRTCPeerConnection||window.mozRTCPeerConnection||window.msRTCPeerConnection;function g(h){if(h)try{h.close()}catch(c){}}const n=[];class t{constructor(h,c,f){this.b=h;this.M=c;this.ca=0;this.pa=f;this.Wb=this.O=null;this.Zc=!1;this.Xb=null;this.ad=!1;this.Yb=null;this.Pf=this.xd=this.Uc=this.mc=this.bd=!1;this.fe=this.th=this.Yf=0;this.Jh=[];this.Fh=this.Eh=0;this.Ha=[];this.S=this.D=this.Ra=null;this.Ch=0;this.Gf=!1;this.Zf=1;this.le=
[];this.Mh=this.ne=0;this.b.pk(this)}Tb(h){this.ca=h}l(){return this===this.b.Z}Jd(){return this===this.b.X}sm(){this.Eh=performance.now()}tm(h){this.Fh=h}Qd(h,c){h.binaryType="arraybuffer";h.onopen=()=>{"o"===c?this.Zc=!0:"r"===c?this.ad=!0:"u"===c&&(this.bd=!0);this.Wk()};h.onmessage=f=>{this.sl(c,f)};h.onerror=f=>{console.error("Peer '"+this.M+"' datachannel '"+c+"' error: ",f);this.b.Wa(this,f);this.b.l()&&!this.l()&&this.aa("network error")};h.onclose=()=>{this.aa("disconnect")}}zg(){if(!this.Jd()){var h=
this.b.l();this.Uc=this.mc=this.bd=this.ad=this.Zc=!1;this.th=performance.now();this.O=new d({iceServers:this.b.Uf});this.O.onicecandidate=f=>{f.candidate&&this.b.Va({message:"icecandidate",toclientid:this.M,icecandidate:f.candidate})};this.O.onsignalingstatechange=()=>{this.O&&"closed"===this.O.signalingState&&this.aa("disconnect")};this.O.oniceconnectionstatechange=()=>{this.O&&("failed"!==this.O.iceConnectionState&&"closed"!==this.O.iceConnectionState||this.aa("disconnect"))};this.O.onconnectionstatechange=
()=>{if(this.O){var f=this.O.connectionState;"failed"!==f&&"closed"!==f||this.aa("disconnect")}};var c=`c2mp_${this.b.Qi()}_${this.b.Ri()}_${this.b.Si()}`;h?(this.ca=this.b.sg(),this.Wb=this.O.createDataChannel("o",{ordered:!0,protocol:c}),this.Qd(this.Wb,"o"),this.Xb=this.O.createDataChannel("r",{ordered:!1,protocol:c}),this.Qd(this.Xb,"r"),this.Yb=this.O.createDataChannel("u",{ordered:!1,maxRetransmits:0,protocol:c}),this.Qd(this.Yb,"u"),this.O.createOffer().then(f=>{this.O.setLocalDescription(f);
this.b.Va({message:"offer",toclientid:this.M,offer:f})}).catch(f=>{console.error("Host error creating offer for peer '"+this.M+"': ",f);this.b.Wa(this,"could not create offer for peer")})):this.O.ondatachannel=f=>{if(f.channel.protocol!==c)console.error("Unexpected datachannel protocol '"+f.channel.protocol+"', should be '"+c+"'"),this.b.Wa(this,"unexpected datachannel protocol '"+f.channel.protocol+"', should be '"+c+"'");else{var b=f.channel.label;"o"===b?this.Wb=f.channel:"r"===b?this.Xb=f.channel:
"u"===b?this.Yb=f.channel:(console.error("Unknown datachannel label: "+f.channel.label),this.b.Wa(this,"unknown datachannel label '"+f.channel.label+"'"));this.Qd(f.channel,b)}}}}async nk(h){if(this.O)try{await this.O.addIceCandidate(h)}catch(c){console.warn("[Multiplayer] Error adding ICE candidate: ",c)}}fj(){return!!this.O}Wk(){!this.mc&&this.ad&&this.bd&&this.Zc&&(this.wl(),this.mc=!0,this.Uc=!1)}wl(){this.Yf=performance.now();if(this.b.l()){this.b.Dc("o",JSON.stringify({c:"j",i:this.M,n:this.ca,
a:this.pa}),this);this.Cb("o",JSON.stringify({c:"hi",hn:this.b.Z.ca,n:this.ca,d:this.b.Pa,u:this.b.nd,objs:this.b.bj(),cvs:this.b.Pi()}));for(const h of this.b.Ya)!h.l()&&h!==this&&h.Se()&&this.Cb("o",JSON.stringify({c:"j",i:h.M,n:h.ca,a:h.pa}))}else this.Pf=!0,this.l()&&this.$e(performance.now(),!0);this.b.gh(this)}Vk(h){!this.Uc&&this.mc&&(this.uf(h),this.Uc=!0,this.mc=!1)}uf(h){this.b.l()&&!this.Jd()&&this.b.Dc("o",JSON.stringify({c:"l",i:this.M,a:this.pa,r:h}),this);this.Jd()||this.b.fh(this,
h)}Se(){return this.mc&&!this.Uc}Cb(h,c){this.b.gk();var f=0;c.length?f=c.length:c.byteLength&&(f=c.byteLength);this.b.ek(f);f=this.b.jg;const b=this.b.ig,e=this.b.kg;if(!(0<f&&"u"===h&&Math.random()<f))if(0===b&&0===e)this.Xg(h,c);else{let p=1;"u"!==h&&Math.random()<f&&(p=3);setTimeout(()=>this.Xg(h,c),b*p+Math.random()*e*p)}}Xg(h,c){try{"o"===h?this.Zc&&this.Wb&&this.Wb.send(c):"r"===h?this.ad&&this.Xb&&this.Xb.send(c):"u"===h&&this.bd&&this.Yb&&this.Yb.send(c)}catch(f){this.xd||(this.b.l()?"o"===
h||"r"===h?("string"===typeof c?(console.error("Error sending "+c.length+"-char string on '"+h+"' to '"+this.pa+"', host kicking: ",f),console.log("String that failed to send from previous error was: "+c)):console.error("Error sending "+(c.length||c.byteLength)+"-byte binary on '"+h+"' to '"+this.pa+"', host kicking: ",f),this.aa("network error")):(this.fe++,10<=this.fe&&("string"===typeof c?(console.error("Too many errors ("+this.fe+") sending data on '"+h+"' to '"+this.pa+"', kicking; last error was for sending "+
c.length+"-char string: ",f),console.log("String that failed to send from previous error was: "+c)):console.error("Too many errors ("+this.fe+") sending data on '"+h+"' to '"+this.pa+"', kicking; last error was for sending "+(c.length||c.byteLength)+"-byte binary: ",f),this.aa("network error"))):console.error("Error sending data on '"+h+"': ",f))}}$e(h,c){this.xd||(!c&&!this.Se()&&this.O&&25E3<h-this.th?(console.warn("Timed out '"+this.pa+"', could not establish connection after 25sec"),this.aa("timeout")):
!c&&this.Se()&&2E4<h-this.Yf?(console.warn("Timed out '"+this.pa+"', not heard from for 20sec"),this.aa("timeout")):(this.Ch=h,this.Gf=!0,this.Zf++,this.Cb("u","ping:"+this.Zf)))}Jj(h){h="pong:"+h.substr(5);this.b.l()&&(h=h+"/"+Math.round(performance.now()).toString());this.Cb("u",h)}Al(h){if(this.Gf){var c=h.indexOf(":");if(-1<c){if(parseFloat(h.substr(c+1))===this.Zf){c=performance.now();this.Gf=!1;var f=(c-this.Ch)/2;this.le.push(f);10<this.le.length&&this.le.shift();n.push(...this.le);n.sort((r,
v)=>r-v);this.Mh=n[n.length-1]-n[0];var b=0,e=n.length;4<=n.length&&6>=n.length?(++b,--e):6<n.length&&(b+=2,e-=2);var p=0;for(let r=b;r<e;++r)p+=n[r];this.ne=p/(e-b);n.length=0;this.b.l()||(b=h.indexOf("/"),-1<b?(h=parseFloat(h.substr(b+1)),isFinite(h)?this.b.ei(h,c,f,this.ne):console.warn("Invalid host time from pong response")):console.warn("Cannot parse off host time from pong response"))}}else console.warn("Cannot parse off ping ID from pong")}}sl(h,c){const f=this.b.jg,b=this.b.ig,e=this.b.kg;
if(!(0<f&&"u"===h&&Math.random()<f))if(0===b&&0===e)this.Wg(h,c);else{let p=1;"u"!==h&&Math.random()<f&&(p=3);setTimeout(()=>this.Wg(h,c),b*p+Math.random()*e*p)}}Wg(h,c){if(!this.xd){this.Yf=performance.now();this.b.fk();var f=0;c.data.length?f=c.data.length:c.data.byteLength&&(f=c.data.byteLength);this.b.dk(f);if("string"===typeof c.data){if(!(""===c.data.trim()||4>c.data.length))if(h=c.data.substr(0,4),"ping"===h)this.Jj(c.data);else if("pong"===h)this.Al(c.data);else{try{var b=JSON.parse(c.data)}catch(e){this.b.Wa(this,
e);this.b.l()?(console.error("Error parsing message as JSON for peer '"+this.M+"', host kicking: ",e),this.aa("data error")):console.error("Error parsing message as JSON for peer '"+this.M+"': ",e);console.log("String that failed to parse from previous error: "+c.data);return}if(b)try{b.c&&"m"!==b.c?this.al(b):this.b.xl(this,b)}catch(e){this.b.Wa(this,e),this.b.l()?(console.error("Error handling message for peer '"+this.M+"', host kicking: ",e),this.aa("data error")):console.error("Error handling message for peer '"+
this.M+"': ",e)}}}else{!this.Pf&&this.b.l()&&"u"===h&&(this.Pf=!0,this.b.Yj(this.M));try{this.$k(c.data)}catch(e){this.b.Wa(this,e),this.b.l()?(console.error("Error handling binary update for peer '"+this.M+"', host kicking: ",e),this.aa("data error")):console.error("Error handling binary update for peer '"+this.M+"': ",e)}}}}al(h){switch(h.c){case "disconnect":h.k&&B(this.b,"peer-kicked");var c=!this.b.l()&&!this.l();this.aa(h.r);c&&this.b.df();break;case "hi":this.b.l()||(this.b.Z.Tb(h.hn),this.b.X.Tb(h.n),
this.b.Mj(h.d),this.b.Tj(h.u),this.b.tj(h.objs),this.b.sj(h.cvs));break;case "j":this.b.l()||(c=new t(this.b,h.i,h.a),c.Tb(h.n),this.b.gh(c));break;case "l":!this.b.l()&&(c=this.b.Fd(h.i))&&(c.Jd()||this.b.fh(c,h.r),c.aa(h.r));break;default:console.error("Unknown control message from peer '"+this.M+"': "+h.c),this.b.Wa(this,"unknown control message '"+h.c+"'")}}$k(h){this.b.l()?this.ol(h):this.yl(h)}ol(h){h=new DataView(h);let c=0;var f=h.getUint32(c);c+=4;if(1664249200!==f)console.warn("Rejected packet with incorrect magic number (received '"+
f+"', expected '1664249200'");else if(f=h.getFloat64(c),c+=8,f+=this.ne,!(3E3<=Math.abs(f-performance.now()))){h.getUint8(c);c+=1;var b=h.getUint8(c);c+=1;var e=[],p=this.b.Xa;for(let v=0;v<b;++v)if(v>=p.length)e.push(0);else{var r=p[v];switch(r.Jb){case 0:r=h.getFloat64(c);c+=8;break;case 1:r=h.getFloat32(c);c+=4;break;case 2:r=r.Ld(h.getInt16(c));c+=2;break;case 3:r=r.Ld(h.getUint8(c));c+=1;break;default:r=h.getFloat32(c),c+=4}e.push(r)}this.mk(f,e)}}mk(h,c){for(let f=0,b=this.Ha.length;f<b;++f){const e=
this.Ha[f];if(e.timestamp===h)return;if(e.timestamp>h){this.Ha.splice(f,0,new k(h,c));return}}this.Ha.push(new k(h,c))}va(h){if(0!==this.Ha.length){for(;2<this.Ha.length&&this.Ha[0]!==this.Ra&&this.Ha[0]!==this.D&&this.Ha[0]!==this.S;)this.Ha.shift();if(!(this.S&&this.S.timestamp>h&&this.D&&this.D.timestamp<h)){this.S=null;for(let c=0,f=this.Ha.length;c<f;++c){const b=this.Ha[c];if(b.timestamp<=h){if(!this.D||b.timestamp>this.D.timestamp)this.Ra=this.D,this.D=b}else{this.S=b;break}}}}}yl(h){h=new DataView(h);
let c=0;var f=h.getUint32(c);c+=4;1664249200!==f?console.warn("Rejected packet with incorrect magic number (received '"+f+"', expected '1664249200'"):(f=h.getUint32(c),c+=4,0===f?this.Qk(h,c):1===f?this.Pk(h,c):console.warn("Ignoring packet with incorrect flags (received "+f+", expected 0 or 1"))}Qk(h,c){const f=h.getFloat64(c);c+=8;const b=h.getUint16(c);c+=2;for(let v=0;v<b;++v){var e=h.getUint16(c);c+=2;var p=h.getUint8(c);c+=1;let x=null,C=0;const D=this.b.Eg(e);D?(x=D.Ia,C=x.length,1===p&&D.qm()):
console.warn("Don't know which object corresponds to NID "+e);e=h.getUint16(c);c+=2;p=h.getUint16(c);c+=2;for(let H=0;H<e;++H){const m=h.getUint16(c);c+=2;if(D){const q=[];let w=c;for(let l=0;l<C;++l){var r=x[l];switch(r.Jb){case 0:r=h.getFloat64(w);w+=8;break;case 1:r=h.getFloat32(w);w+=4;break;case 2:r=r.Ld(h.getInt16(w));w+=2;break;case 3:r=r.Ld(h.getUint8(w));w+=1;break;default:r=h.getFloat32(w),w+=4}q.push(r)}D.Ie(f,m,q)}c+=p}}}Pk(h,c){const f=h.getFloat64(c);c+=8;const b=h.getUint16(c);c+=2;
for(let p=0;p<b;++p){var e=h.getUint16(c);c+=2;const r=this.b.Eg(e);r||console.warn("Don't know which object corresponds to NID "+e);e=h.getUint16(c);c+=2;for(let v=0;v<e;++v){const x=h.getUint16(c);c+=2;r&&!r.nc&&(this.b.pl(r,x,f),r.Xe(x))}}}aa(h,c){if(!this.xd){this.xd=!0;this.Vk(h);this.Cb("o",JSON.stringify({c:"disconnect",r:h,k:!!c}));var f=this.Wb,b=this.Xb,e=this.Yb,p=this.O;setTimeout(()=>{g(f);g(b);g(e);g(p)},0);this.O=this.Yb=this.Xb=this.Wb=null;this.bd=this.ad=this.Zc=!1;this.b.dm(this)}}Vi(h){h=
h.Wc;if(!this.S&&!this.D)return 0;if(this.S&&!this.D){var c=this.S.data;return 0>h||h>=c.length?0:c[h]}var f=this.b.Gd();let b,e;if(!this.S&&this.D){if(this.Ra){var p=this.Ra.timestamp;c=this.Ra.data[h];b=this.D.timestamp;e=this.D.data[h];f>this.D.timestamp+250&&(f=this.D.timestamp+250);p=p===b?0:(f-p)/(b-p);return a.Id(this.b.Xa[h].Ab(),c,e,p,!0)}c=this.D.data;return 0>h||h>=c.length?0:c[h]}p=this.D.timestamp;c=this.D.data[h];b=this.S.timestamp;e=this.S.data[h];p=p===b?0:(f-p)/(b-p);return a.Id(this.b.Xa[h].Ab(),
c,e,p,!1)}}self.Bi=t}"use strict";
{const k=self.xg,a=self.Bi,d=window.RTCPeerConnection||window.webkitRTCPeerConnection||window.mozRTCPeerConnection||window.msRTCPeerConnection,g=window.RTCSessionDescription||window.webkitRTCSessionDescription||window.mozRTCSessionDescription||window.msRTCSessionDescription,n=window.RTCIceCandidate||window.webkitRTCIceCandidate||window.mozRTCIceCandidate||window.msRTCIceCandidate,t=window.RTCDataChannel||window.webkitRTCDataChannel||window.mozRTCDataChannel||window.msRTCDataChannel,h=[{urls:"stun:stun.l.google.com:19302"}];
let c=!1;const f=[];self.Ua.Lb(class extends self.zb{constructor(b){super(b,"multiplayer");this.Uf=[];this.da=null;this.Ea=this.eb=!1;this.Um={bi:0,version:0,name:"",Zh:"",Yh:""};this.xa=this.Nf=this.Mf=this.dg=this.eg="";this.Ya=[];this.tb=new Map;this.sc=0;this.Ce=new Set;this.Z=this.X=null;this.Pa=80;this.nd=this.Tf=30;this.Hh=0;this.cc={Ad:0,ai:0,pg:0,$h:0,Ge:0,Xh:0,ng:0,Wh:0,Fe:0};this.ae=new ArrayBuffer(262144);this.Jf=new DataView(this.ae);this.Oa=[];this.Qm=1;this.qd=new Map;this.rd=new Map;
this.jg=this.kg=this.ig=0;this.ac=[];this.ma=this.fb=0;this.ya=this.wb=this.Pa;this.Xa=[];this.$d=new Map;this.hg=!1;this.rf(h);setInterval(()=>this.Dk(),2E3);window.addEventListener("unload",()=>this.Ic("quit"));L(this,"get-supported",()=>this.ll());L(this,"add-ice-servers",e=>this.rf(e.list));L(this,"simulate-latency",e=>this.Qj(e.latency,e.pdv,e.loss));L(this,"set-bandwidth-profile",e=>this.Lj(e.updateRate,e.delay));L(this,"tick",e=>this.va(e));L(this,"alert",e=>this.gi(e));L(this,"signalling-connect",
e=>this.Zj(e.url));L(this,"signalling-disconnect",()=>this.Rg());L(this,"signalling-login",e=>this.ak(e.alias));L(this,"signalling-join-room",e=>this.$j(e.game,e.instance,e.room,e.maxClients));L(this,"signalling-auto-join-room",e=>this.Xj(e.game,e.instance,e.room,e.maxClients,e.lock));L(this,"signalling-leave-room",()=>this.df());L(this,"signalling-list-game-instances",e=>this.bk(e.game));L(this,"signalling-list-rooms",e=>this.ck(e.game,e.instance,e.which));L(this,"disconnect-room",()=>this.Cg(!0));
L(this,"peer-send-message",e=>this.xj(e));L(this,"host-broadcast",e=>this.vj(e));L(this,"kick-peer",e=>this.wj(e));L(this,"sync-object",e=>this.Bj(e));L(this,"sync-inst-var",e=>this.Aj(e));L(this,"associate-object",e=>this.uj(e));L(this,"remove-object-id",e=>this.We(e.uid));L(this,"remove-net-insts",e=>this.yj(e));L(this,"remove-object-nid",e=>this.zj(e));L(this,"set-client-state",e=>this.Ng(e.tag,e.value));L(this,"add-client-input-value",e=>this.ci(e.tag,e.precision,e.interp))}Kk(b){return b?"string"===
typeof b?b:"string"===typeof b.message?b.message:"string"===typeof b.details?b.details:"string"===typeof b.data?b.data:"string"===typeof b.type?b.type:"unknown error":"unknown error"}Re(){return this.eb&&this.Ea}Fc(){return this.Re()&&this.xa}l(){return this.Fc()&&this.X&&this.Z===this.X}Qi(){return this.Re()?this.Mf:""}Ri(){return this.Re()?this.Nf:""}Si(){return this.Fc()?this.xa:""}Qj(b,e,p){this.ig=Math.max(b,0);this.kg=Math.max(e,0);this.jg=Math.max(p,0)}ll(){return{isSupported:!(!d||!t)}}Zj(b){if(!this.da&&
!this.eb){try{this.da=new WebSocket(b,"c2multiplayer")}catch(e){this.da=null;this.Sb(e);return}this.da.onopen=()=>{-1===this.da.protocol.indexOf("c2multiplayer")?(this.Sb("server does not support 'c2multiplayer' protocol"),this.da.close(1002,"'c2multiplayer' protocol required"),this.da=null,this.eb=!1):this.eb=!0};this.da.onclose=()=>{this.Hl();this.Ea=this.eb=!1;this.da=null};this.da.onerror=e=>{console.error("Signalling server error: ",e);this.Sb(e)};this.da.onmessage=e=>{this.Il(e)}}}Rg(){this.da&&
this.eb&&(this.da.close(),this.da=null,this.eb=!1)}Il(b){let e;try{e=JSON.parse(b.data)}catch(p){this.Sb(p);return}switch(e.message){case "welcome":this.Ul(e);break;case "login-ok":this.Pl(e);break;case "join-ok":this.Ml(e);break;case "leave-ok":this.Ol();break;case "kicked":this.Nl();break;case "peer-joined":this.Rl(e);break;case "peer-quit":this.Sl(e);break;case "icecandidate":this.Kl(e);break;case "offer":this.Ql(e);break;case "answer":this.Jl(e);break;case "instance-list":this.Ll(e);break;case "room-list":this.Tl(e);
break;case "error":this.Sb(e.details);break;default:this.Sb("received unknown signalling message")}}dj(b){for(const e of this.Uf)if(e.urls===b.urls)return!0;return!1}rf(b){if(b)for(let e of b)"string"===typeof e&&(e={urls:e}),this.dj(e)||(e.hasOwnProperty("url")||(e.url=e.urls),this.Uf.push(e))}Sb(b){B(this,"signalling-error",{message:this.Kk(b)})}Hl(){B(this,"signalling-close")}Ul(b){if(1>b.protocolrev||1<b.protocolrev)this.Sb("signalling server protocol revision not supported"),this.Rg();else{this.eg=
b.clientid;var e=this.Um;e.bi=b.protocolrev;e.version=b.version;e.name=b.name;e.Zh=b.operator;e.Yh=b.motd;this.rf(b.ice_servers);B(this,"signalling-welcome",{myid:this.eg,sigservinfo:{protocolrev:e.bi,version:e.version,name:e.name,operator:e.Zh,motd:e.Yh}})}}Pl(b){this.dg=b.alias;this.Ea=!0;B(this,"signalling-login-ok",{myalias:this.dg})}$i(){return this.Qm++}sg(){if(this.l()){do this.sc++,65535<this.sc&&(this.sc=0);while(this.Ce.has(this.sc));var b=this.sc;this.Ce.add(b);return b}}Ni(b){this.l()&&
this.Ce.delete(b)}Ml(b){this.Ic("disconnect");this.Mf=b.game;this.Nf=b.instance;this.xa=b.room;this.X=new a(this,this.eg,this.dg);b.host?(this.Z=this.X,this.sc=0,this.Ce.clear(),this.Z.Tb(this.sg())):(this.ma=this.fb=this.ac.length=0,this.Pa=80,this.nd=this.Tf=30,this.ya=this.wb=this.Pa,this.Z=new a(this,b.hostid,b.hostalias),this.Z.zg());B(this,"signalling-join-ok",{isHost:!!b.host,hostId:this.Z.M,hostAlias:this.Z.pa,game:this.Mf,gameInstance:this.Nf,room:this.xa})}Ol(){this.xa="";B(this,"signalling-leave-ok")}Nl(){this.Cg();
this.xa="";B(this,"signalling-kicked")}Rl(b){if(this.Ea&&this.xa&&this.l()){var e=this.tb.get(b.peerid);e&&e.aa("rejoin");(new a(this,b.peerid,b.peeralias)).zg()}}Sl(b){if(this.Ea&&this.xa&&this.l()){var e=this.tb.get(b.id);e&&e.aa(b.reason)}}Kl(b){if(this.Ea&&this.xa){var e=this.tb.get(b.from);e&&e.nk(new n(b.icecandidate))}}Ql(b){if(this.Ea&&this.xa&&!this.l()&&this.X&&this.Z&&this.Z.fj()&&b.from===this.Z.M){var e=this.Z.O;e.setRemoteDescription(new g(b.offer)).then(()=>{e.createAnswer().then(p=>
{e.setLocalDescription(p);this.Va({message:"answer",toclientid:this.Z.M,answer:p})}).catch(p=>{console.error("Peer error creating answer: ",p);this.Wa(this.X,"could not create answer to host offer")})}).catch(p=>{console.error("Peer error setting remote description: ",p);this.Wa(this.X,"could not set remote description")})}}Jl(b){if(this.Ea&&this.xa&&this.l()){var e=this.tb.get(b.from);e&&e.O.setRemoteDescription(new g(b.answer)).catch(p=>{console.error("Host error setting remote description: ",p)})}}Ll(b){B(this,
"signalling-instance-list",{list:b.list})}Tl(b){B(this,"signalling-room-list",{list:b.list})}Va(b){this.da&&this.eb&&this.da.send(JSON.stringify(b))}ak(b){this.Ea||this.Va({message:"login",protocolrev:1,alias:b})}$j(b,e,p,r){this.Ea&&!this.xa&&this.Va({message:"join",game:b,instance:e,room:p,max_clients:r})}Xj(b,e,p,r,v){this.Ea&&!this.xa&&this.Va({message:"auto-join",game:b,instance:e,room:p,max_clients:r,lock_when_full:v})}df(){this.Ea&&this.Va({message:"leave"})}Yj(b){this.Ea&&this.l()&&this.Va({message:"confirm-peer",
id:b})}bk(b){this.da&&this.eb&&this.Va({message:"list-instances",game:b})}ck(b,e,p){this.da&&this.eb&&this.Va({message:"list-rooms",game:b,instance:e,which:p})}Cg(b){this.ma=this.fb=this.ac.length=0;this.Ic("disconnect");for(const e of this.Oa)e.Hi();b&&this.df()}pk(b){this.Ya.push(b);this.tb.set(b.M,b);B(this,"add-peer",{id:b.M,alias:b.pa})}dm(b){B(this,"remove-peer",{id:b.M});this.l()&&this.Ni(b.ca);const e=this.Ya.indexOf(b);-1<e&&this.Ya.splice(e,1);this.tb.delete(b.M);this.Z===b&&(this.Z=null,
this.Ic("host quit"));this.X===b&&(this.X=null,this.xa="",this.Ic("disconnect"))}Ic(b){if(!c){for(c=!0;this.Ya.length;)this.Ya[0].aa(b);c=!1}}Fd(b){return this.tb.get(b)||null}Oi(b){return(b=this.tb.get(b))?b.pa:""}vj(b){const e=b.fromId,p=b.tag,r=b.message;b=b.mode;const v=this.Fd(e);this.Dc(b,JSON.stringify({c:"m",t:p,f:e,m:r}),v)}Dc(b,e,p){if(this.l()){var r=this.Ya.slice(0);for(const v of r)v&&v!==this.X&&v!==p&&v.Cb(b,e)}}Dk(){const b=performance.now();if(this.l()){f.push(...this.Ya);for(const e of f)e&&
e!==this.X&&e.$e(b,!1);f.length=0}else this.Z&&this.Z.$e(b,!1)}fi(b){this.Oa.push(b);this.rd.set(b.td,b);this.qd.set(b.ca,b)}bj(){const b={};for(const [e,p]of this.qd.entries())b[p.ud]={nid:e,nvs:p.Zi()};return b}tj(b){this.qd.clear();for(const e of this.Oa)if(b.hasOwnProperty(e.ud.toString())){const p=b[e.ud.toString()];e.Tb(p.nid);this.qd.set(p.nid,e);e.Rj(p.nvs)}else console.warn("Could not map object SID '"+e.ud+"' - host did not send NID for it"),e.Tb(-1)}Eg(b){return this.qd.get(b)||null}va(b){if(!this.Fc())return null;
b=b.dt;const e=performance.now();e-this.Hh>=1E3/(this.l()?this.Tf:this.nd)-5&&(this.Kj(e),this.Hh=e);const p=this.cc;1E3<=e-p.Ad&&(p.ai=p.pg,p.$h=p.Ge,p.Xh=p.ng,p.Wh=p.Fe,p.pg=0,p.Ge=0,p.ng=0,p.Fe=0,p.Ad+=1E3,500<e-p.Ad&&(p.Ad=e),B(this,"stats",{stats:{outboundPerSec:p.ai,outboundBandwidthPerSec:p.$h,inboundPerSec:p.Xh,inboundBandwidthPerSec:p.Wh}}));this.l()||(this.ma<this.fb?(this.ma+=10*b,this.ma>this.fb&&(this.ma=this.fb)):this.ma>this.fb&&(this.ma-=10*b,this.ma<this.fb&&(this.ma=this.fb)),this.ya<
this.wb?(this.ya+=30*b,this.ya>this.wb&&(this.ya=this.wb)):this.ya>this.wb&&(this.ya-=30*b,this.ya<this.wb&&(this.ya=this.wb)));b=this.Gd();for(const r of this.Ya)r.va(b);for(const r of this.Oa)r.va();return{simulationTime:this.Gd(),hostInputArrivalTime:this.Ui(),clientDelay:this.Pa,peerData:this.Mk(),roData:this.Nk(),isReadyForInput:this.Hg()}}Mk(){const b={};for(const e of this.Ya){const p={};for(const r of this.Xa)p[r.ja]=e.Vi(r);b[e.M]={nid:e.ca,latency:e.ne,pdv:e.Mh,clientState:p}}return b}Nk(){const b=
{};for(const e of this.Oa)b[e.td]=e.fc();return b}async Kj(b){this.l()?(await this.km(b),this.jm(b)):await this.im(b)}async Yk(){const b=await E(this,"before-client-update");for(const e of b.clientStateUpdates)this.Ng(e.tag,e.value)}async im(b){this.Hg()&&await this.Yk();if(this.X&&this.hg){var e=this.Jf,p=0,r=this.Xa,v=this.X.Jh,x=b-this.X.Eh,C=b-this.X.Fh;if(100>x||(1E3>x?95<=C:495<=C)){e.setUint32(p,1664249200);p+=4;e.setFloat64(p,b+this.ma);p+=8;e.setUint8(p,0);p+=1;e.setUint8(p,r.length);p+=
1;for(let D=0,H=r.length;D<H;++D)x=r[D],C=0,D<v.length&&(C=x.yg(v[D])),p=x.Tg(e,p,C);this.X.tm(b);this.Z.Cb("u",new Uint8Array(this.ae.slice(0,p)))}}}async km(b){const e=this.Jf;let p=0,r=0;const v=await E(this,"get-object-info",{ros:this.Oa.map(x=>x.cj())});for(const x of this.Oa){const C=x.td;v.hasOwnProperty(C)&&(x.gf(v[C],b),0<x.ld&&r++)}if(0!==r){e.setUint32(p,1664249200);p+=4;e.setUint32(p,0);p+=4;e.setFloat64(p,b);p+=8;e.setUint16(p,r);p+=2;for(const x of this.Oa)0<x.ld&&(p=x.hf(e,p,b));this.Dc("u",
new Uint8Array(this.ae.slice(0,p)),null)}}jm(b){const e=this.Jf;let p=0,r=0;for(const v of this.Oa)v.be.length&&r++;if(0!==r){e.setUint32(p,1664249200);p+=4;e.setUint32(p,1);p+=4;e.setFloat64(p,b);p+=8;e.setUint16(p,r);p+=2;for(const v of this.Oa)if(b=v.be,b.length){e.setUint16(p,v.ca);p+=2;e.setUint16(p,b.length);p+=2;for(const x of b)e.setUint16(p,x),p+=2;b.length=0}this.Dc("r",new Uint8Array(this.ae.slice(0,p)),null)}}ei(b,e,p,r){if(!this.l()){this.wb=r+this.Pa;b=b+p-e;0===this.ac.length&&(this.ma=
b,this.ya=this.wb);this.ac.push(b);30<this.ac.length&&this.ac.shift();f.push(...this.ac);f.sort((v,x)=>v-x);b=0;e=f.length;4<=f.length&&6>=f.length?(++b,--e):6<f.length&&19>=f.length?(b+=2,e-=2):19<f.length&&(b+=5,e-=5);p=0;for(r=b;r<e;++r)p+=f[r];this.fb=p/(e-b);f.length=0}}Gd(){return this.l()?performance.now()-this.Pa:performance.now()+this.ma-this.ya}Ui(){return this.l()?performance.now():performance.now()+this.ma+this.ya}Ng(b,e){if(!this.l()&&this.X&&this.hg&&(b=this.$d.get(b))){b=b.Wc;var p=
this.X.Jh;p.length<b+1&&(p.length=b+1);p[b]!==e&&(p[b]=e,this.X.sm())}}ci(b,e,p){e=new k(this.Xa.length,p,e,b,null);this.$d.set(b,e);this.Xa.push(e)}Pi(){const b=[];for(const e of this.Xa)b.push({tag:e.ja,precision:e.Jb,interp:e.Ab()});return b}sj(b){this.$d.clear();this.Xa.length=0;for(let p=0,r=b.length;p<r;++p){var e=b[p];e=new k(p,e.interp,e.precision,e.tag,null);this.$d.set(e.ja,e);this.Xa.push(e)}this.hg=!0}We(b){for(const e of this.Oa)e.We(b)}Hg(){return this.Fc()?this.l()?!0:0!==this.fb:!1}Lj(b,
e){this.Fc()||(this.nd=this.Tf=b,this.Pa=e)}gh(b){B(this,"peer-open",{id:b.M,alias:b.pa})}xj(b){const e=b.tag,p=b.message,r=b.mode;(b=this.Fd(b.id))&&b.Cb(r,JSON.stringify({c:"m",t:e,m:p}))}fh(b,e){B(this,"peer-close",{id:b.M,alias:b.pa,reason:e||"unknown"})}Wa(b,e){console.error(`[Multiplayer] Peer '${b.pa}' (${b.M}) error: `,e)}xl(b,e){b=e.f||b.M;B(this,"peer-message",{tag:e.t,fromId:b,fromAlias:this.Oi(b),content:e.m})}pl(b,e,p){B(this,"instance-destroyed",{roId:b.td,nid:e,timestamp:p})}wj(b){if(this.l()){var e=
b.reason;(b=this.Fd(b.id))&&b.aa(e,!0)}}gk(){this.cc.pg++}ek(b){this.cc.Ge+=b}fk(){this.cc.ng++}dk(b){this.cc.Fe+=b}Mj(b){this.Pa=b}Tj(b){this.nd=b}Bj(b){const e=b.data,p=b.precision,r=b.bandwidth;for(const v of b.objectClasses)b=new self.Ci(this,v.roId,v.sid,r),1===e?(b.yb(1,p,"x"),b.yb(1,p,"y")):2===e?b.yb(2,p,"a"):3===e&&(b.yb(1,p,"x"),b.yb(1,p,"y"),b.yb(2,p,"a"))}gi(b){alert(b.message)}Aj(b){const e=b.precision,p=b.interp,r=b.cvt;for(const v of b.syncData)this.rd.get(v.roId).yb(p,e,"iv",v.varIndex,
r)}uj(b){var e=b.peerId;const p=b.instUid;b=this.rd.get(b.roId);e=this.tb.get(e);b&&e&&this.l()&&b.Cj(p,e.ca)}yj(b){for(const [e,p]of Object.entries(b))if(b=this.rd.get(parseInt(e,10)))for(const r of p)b.Xe(r)}zj(b){const e=b.nid;(b=this.rd.get(b.roId))&&b.Xe(e)}})}"use strict";
{const k={};let a=null,d=null;const g={banner:"ca-app-pub-3940256099942544/2934735716",interstitial:"ca-app-pub-3940256099942544/4411468910",rewarded:"ca-app-pub-3940256099942544/1712485313",rewardedInterstitial:"ca-app-pub-3940256099942544/6978759866"};let n=!1;function t(c,f){k[c]=f;self.admob.configRequest(k)}async function h(){if("android"===self.cordova.platformId)return self.ug(self.device.uuid).toUpperCase();if("ios"===self.cordova.platformId){const c=await self.cordova.plugins.idfa.$m();if(!c.nn)return n=
!0,self.ug(c.Fn).toUpperCase()}}self.Mb={P:function(c,f){c(null,f)},I:function(c,f){c(f,null)},Na:async function(c,f){f="undefined"!==typeof f?f:a.debug;return d?d:d=new Promise(b=>{document.addEventListener("deviceready",async()=>{try{const e=setTimeout(()=>{b(!1);c("failure to initialize",null)},5E3);await self.admob.start();clearTimeout(e);if(f){const p=await h();t("testDeviceIds",[p])}b(!0)}catch(e){b(!1),c("Initialization failure",null)}})})},ff:t,Nj:function(c,f,b,e,p,r,v){a||(a={id:c,fn:f,
dn:b,kn:e,In:p,debug:r,Xm:v},Object.freeze(a))},ej:function(){return!!a},Cd:function(c,f){if("android"===self.cordova.platformId)return c;if("ios"===self.cordova.platformId){const b=!!g[f];return a.debug&&!n&&b?(console.log("[C3 advert]","USING TEST AD UNITS"),g[f]):c}},get Nb(){return a},get jk(){return h()}}}"use strict";
{const k=self.Mb,a=k.P,d=k.I,g={get na(){return self.admob.Events.bannerLoad},get oa(){return self.admob.Events.bannerLoadFail}};class n{constructor(h,c,f,b){if(!h)return d(b,"Unit ID not specified");if(!c)return d(b,"Ad size not specified");if(!f)return d(b,"Ad position not specified");this.Ub=h;this.Sm=f;this.vb="";switch(c){case "portrait":this.vb=5;break;case "landscape":this.vb=5;break;case "standard":this.vb=0;break;case "large":this.vb=1;break;case "medium":this.vb=2;break;case "full":this.vb=
3;break;case "leaderboard":this.vb=4;break;default:this.vb=5}this.J=null;this.U=this.T=!1}Ja(h,c){if(this.J)return a(c,"banner ad loaded");t.call(this,c);h={adUnitId:k.Cd(this.Ub,"banner"),size:this.vb,position:this.Sm,offset:0,npa:"NON_PERSONALIZED"===h?"1":"0"};this.J=new self.admob.BannerAd(h);this.J.load()}async Db(h){this.J?this.T?d(h,"banner ad still loading"):this.U?a(h,"banner ad already shown"):(await this.J.show(),this.U=!0,a(h,"banner shown")):d(h,"banner ad not created")}async hj(h){this.J?
this.T?d(h,"banner ad still loading"):this.U?(await this.J.hide(),this.U=!1,a(h,"banner ad hidden")):a(h,"banner ad not being shown"):d(h,"banner ad not created")}}function t(h){const c=()=>{this.T=!1;a(h,"banner ad loaded");document.removeEventListener(g.na,c);document.removeEventListener(g.oa,f)},f=()=>{this.J=null;this.T=!1;d(h,"banner ad failed to load");document.removeEventListener(g.na,c);document.removeEventListener(g.oa,f)};document.addEventListener(g.na,c);document.addEventListener(g.oa,
f)}self.vi=n}"use strict";
{const k=self.Mb,a=k.P,d=k.I,g={get na(){return self.admob.Events.interstitialLoad},get oa(){return self.admob.Events.interstitialLoadFail},get Ka(){return self.admob.Events.interstitialShow},get La(){return self.admob.Events.interstitialShowFail},get jb(){return self.admob.Events.interstitialDismiss}};class n{constructor(c,f){if(!c)return d(f,"Unit ID not specified");this.Ub=c;this.J=null;this.$=this.U=this.T=!1;this.wa=null;this.s=this.Y();document.addEventListener(g.jb,async()=>{this.U=!1;this.T=
!0;this.$=!1;this.s=null;this.s=this.Y();t.call(this);await this.J.load()})}Y(){return this.s?this.s:this.s=new Promise(c=>{this.wa=c})}Bb(c){this.$=c;this.wa&&this.wa(c);this.wa=this.s=null;this.s=this.Y()}Ja(c,f){c={adUnitId:k.Cd(this.Ub,"interstitial"),npa:"NON_PERSONALIZED"===c?"1":"0"};this.T=!0;this.$=this.U=!1;this.s=null;this.s=this.Y();this.J=new self.admob.InterstitialAd(c);t.call(this,f);this.J.load()}async Db(c){this.J?this.U?a(c,"interstitial ad already shown"):(this.T&&await this.Y(),
await (async()=>{this.$?(h.call(this,c),await this.J.show()):(t.call(this),this.$=!1,this.s=null,this.J.load(),await this.Y(),this.$?(h.call(this,c),await this.J.show()):d(c,"interstitial ad failed to load"))})()):d(c,"interstitial ad not created")}}function t(c){const f=()=>{this.T=!1;this.Bb(!0);c&&a(c,"interstitial ad load");document.removeEventListener(g.na,f);document.removeEventListener(g.oa,b)},b=()=>{this.T=!1;this.Bb(!1);c&&d(c,"interstitial ad failed to load");document.removeEventListener(g.na,
f);document.removeEventListener(g.oa,b)};document.addEventListener(g.na,f);document.addEventListener(g.oa,b)}function h(c){const f=()=>{this.U=!0;c&&a(c,"interstitial ad show");document.removeEventListener(g.Ka,f);document.removeEventListener(g.La,b)},b=()=>{this.U=!1;c&&d(c,"interstitial ad failed to show");document.removeEventListener(g.Ka,f);document.removeEventListener(g.La,b)};document.addEventListener(g.Ka,f);document.addEventListener(g.La,b)}self.zi=n}"use strict";
{const k=self.Mb,a=k.P,d=k.I,g={get na(){return self.admob.Events.rewardedLoad},get oa(){return self.admob.Events.rewardedLoadFail},get Ka(){return self.admob.Events.rewardedShow},get La(){return self.admob.Events.rewardedShowFail},get jb(){return self.admob.Events.rewardedDismiss},get Qb(){return self.admob.Events.rewardedReward}};class n{constructor(c,f){if(!c)return d(f,"Unit ID not specified");this.Ub=c;this.J=null;this.$=this.U=this.T=!1;this.wa=null;this.s=this.Y();this.Sa=null}Y(){return this.s?
this.s:this.s=new Promise(c=>{this.wa=c})}Bb(c){this.$=c;this.wa&&this.wa(c);this.wa=this.s=null;this.s=this.Y()}Ja(c,f){c={adUnitId:k.Cd(this.Ub,"rewarded"),npa:"NON_PERSONALIZED"===c?"1":"0"};this.T=!0;this.$=this.U=!1;this.s=null;this.s=this.Y();this.J=new self.admob.RewardedAd(c);t.call(this,f);this.J.load()}async Db(c){this.J?this.U?a(c,"rewarded ad already shown"):(this.T&&await this.Y(),await (async()=>{this.$?(h.call(this,c),await this.J.show()):(t.call(this),this.$=!1,this.s=null,this.J.load(),
await this.Y(),this.$?(h.call(this,c),await this.J.show()):d(c,"rewarded ad failed to load"))})()):d(c,"rewarded ad not created")}}function t(c){const f=()=>{this.T=!1;this.Bb(!0);c&&a(c,"rewarded ad load");document.removeEventListener(g.na,f);document.removeEventListener(g.oa,b)},b=()=>{this.T=!1;this.Bb(!1);c&&d(c,"rewarded ad failed to load");document.removeEventListener(g.na,f);document.removeEventListener(g.oa,b)};document.addEventListener(g.na,f);document.addEventListener(g.oa,b)}function h(c){const f=
()=>{this.U=!0},b=r=>{this.Sa=r.reward},e=()=>{this.U=!1;c&&d(c,"rewarded ad failed to show");document.removeEventListener(g.Ka,f);document.removeEventListener(g.La,e);document.removeEventListener(g.Qb,b);document.removeEventListener(g.jb,p)},p=()=>{if(null!==this.Sa){const r=String(this.Sa.type),v=String(this.Sa.amount);c&&a(c,JSON.stringify([r,v]))}else c&&d(c,"closed with no reward");this.Sa=null;this.U=!1;this.T=!0;this.$=!1;this.s=null;this.s=this.Y();t.call(this);this.J.load();document.removeEventListener(g.Ka,
f);document.removeEventListener(g.La,e);document.removeEventListener(g.Qb,b);document.removeEventListener(g.jb,p)};document.addEventListener(g.Ka,f);document.addEventListener(g.La,e);document.addEventListener(g.Qb,b);document.addEventListener(g.jb,p)}self.Di=n}"use strict";
{const k=self.Mb,a=k.P,d=k.I,g={get na(){return self.admob.Events.rewardedInterstitialLoad},get oa(){return self.admob.Events.rewardedInterstitialLoadFail},get Ka(){return self.admob.Events.rewardedInterstitialShow},get La(){return self.admob.Events.rewardedInterstitialShowFail},get jb(){return self.admob.Events.rewardedInterstitialDismiss},get Qb(){return self.admob.Events.rewardedInterstitialReward}};class n{constructor(c,f){if(!c)return d(f,"Unit ID not specified");this.Ub=c;this.J=null;this.$=
this.U=this.T=!1;this.wa=null;this.s=this.Y();this.Sa=null}Y(){return this.s?this.s:this.s=new Promise(c=>{this.wa=c})}Bb(c){this.$=c;this.wa&&this.wa(c);this.wa=this.s=null;this.s=this.Y()}Ja(c,f){c={adUnitId:k.Cd(this.Ub,"rewardedInterstitial"),npa:"NON_PERSONALIZED"===c?"1":"0"};this.T=!0;this.$=this.U=!1;this.s=null;this.s=this.Y();this.J=new self.admob.RewardedInterstitialAd(c);t.call(this,f);this.J.load()}async Db(c){this.J?this.U?a(c,"rewarded interstitial ad already shown"):(this.T&&await this.Y(),
await (async()=>{this.$?(h.call(this,c),await this.J.show()):(t.call(this),this.$=!1,this.s=null,this.J.load(),await this.Y(),this.$?(h.call(this,c),await this.J.show()):d(c,"rewarded interstitial ad failed to load"))})()):d(c,"rewarded interstitial ad not created")}}function t(c){const f=()=>{this.T=!1;this.Bb(!0);c&&a(c,"rewarded interstitial ad load");document.removeEventListener(g.na,f);document.removeEventListener(g.oa,b)},b=()=>{this.T=!1;this.Bb(!1);c&&d(c,"rewarded interstitial ad failed to load");
document.removeEventListener(g.na,f);document.removeEventListener(g.oa,b)};document.addEventListener(g.na,f);document.addEventListener(g.oa,b)}function h(c){const f=()=>{this.U=!0},b=r=>{this.Sa=r.reward},e=()=>{this.U=!1;c&&d(c,"rewarded interstitial ad failed to show");document.removeEventListener(g.Ka,f);document.removeEventListener(g.La,e);document.removeEventListener(g.Qb,b);document.removeEventListener(g.jb,p)},p=()=>{if(null!==this.Sa){const r=String(this.Sa.type),v=String(this.Sa.amount);
c&&a(c,JSON.stringify([r,v]))}else c&&d(c,"closed with no reward");this.Sa=null;this.U=!1;this.T=!0;this.$=!1;this.s=null;this.s=this.Y();t.call(this);this.J.load();document.removeEventListener(g.Ka,f);document.removeEventListener(g.La,e);document.removeEventListener(g.Qb,b);document.removeEventListener(g.jb,p)};document.addEventListener(g.Ka,f);document.addEventListener(g.La,e);document.addEventListener(g.Qb,b);document.addEventListener(g.jb,p)}self.Ei=n}"use strict";
{const k=self.Mb,a=k.P,d=k.I,g=self.cordova?"ios"===self.cordova.platformId:!1,n=self.cordova?"android"===self.cordova.platformId:!1;class t{constructor(){this.mb="UNKNOWN";this.nb="";this.Oc=0;this.lc="UNKNOWN";this.gb="not-determined";this.Qf=!1}async Ye(){k.Nb.debug&&await self.consent.reset()}async Lg(){g&&await self.admob.requestTrackingAuthorization()}async Hd(){if(n)return this.gb="not-determined";const v=self.cordova.plugins.idfa,x=await v.$m();if(!x.nn)return this.gb="authorized";switch(x.Kn){case v.yn:return this.gb=
"not-determined";case v.zn:return this.gb="denied";case v.xn:return this.gb="denied";case v.wn:return this.gb="authorized"}}async Gj(v){n?a(v,"not-determined"):g&&(await e.call(this),"true"===this.nb?await this.Lg():(await this.Hd(),"not-determined"===this.gb&&(await h.call(this),this.Qf?await this.Wj():await this.Lg())),await this.Hd(),a(v,this.gb))}async Hj(v,x,C){return await r.call(this,v,x,D=>{D?"object"===typeof D?d(C,D.message):d(C,D):d(C,"requestInfoUpdate error")})}async Ij(v,x){await r.call(this,
v,x)}async cf(v,x=!1){await c.call(this);switch(v){case "eu":x=await h.call(this);f.call(this)&&x&&await (await self.consent.loadForm()).show();break;case "always":{v=await h.call(this);const C=await e.call(this);v&&"true"===C?await (await self.consent.loadForm()).show():v&&x&&await (await self.consent.loadForm()).show()}}await c.call(this);await e.call(this);await b.call(this)}async Wj(){await this.cf("always",!0)}async Sg(){await c.call(this);await e.call(this);await b.call(this)}async ik(v){await this.Hd();
a(v,`${this.lc}&&${this.gb}&&${this.nb}`)}async Le(v,x){d(v,x)}async hk(v){await this.Sg();await this.Hd();a(v,`${this.lc}&&${this.gb}&&${this.nb}`)}}async function h(){return this.Qf=await self.consent.getFormStatus()===self.consent.FormStatus.Available}async function c(){this.Oc=await self.consent.getConsentStatus();switch(this.Oc){case 1:return this.lc="REQUIRED";case 2:return this.lc="NOT_REQUIRED";case 3:return this.lc="OBTAINED";case 0:return this.lc="UNKNOWN"}}function f(){switch(this.Oc){case 1:return!0;
case 2:return!1;case 3:return!1;case 0:return!0}}function b(){switch(this.Oc){case 1:return this.mb="NON_PERSONALIZED";case 2:return this.mb="PERSONALIZED";case 3:return this.mb="PERSONALIZED";case 0:return this.mb="NON_PERSONALIZED"}}async function e(){if(n)switch(this.Oc){case 1:return this.nb="true";case 2:return this.nb="false";case 3:return this.nb="true";case 0:return this.nb="true"}if(g)return await p.call(this,"IABTCF_gdprApplies","getInt")?this.nb="true":this.nb="false"}async function p(v,
x){return new Promise(C=>{self.NativeStorage[x](v,D=>C(D),()=>C(1))})}async function r(v,x,C){let D="",H=null;if(v){switch(x){case "EEA":D=self.consent.DebugGeography.EEA;break;case "NOT_EEA":D=self.consent.DebugGeography.NotEEA;break;default:D=self.consent.DebugGeography.Disabled}H=[await k.jk]}try{return v?await self.consent.requestInfoUpdate({Dn:D,Jn:H}):await self.consent.requestInfoUpdate(),!0}catch(m){return C&&C(m),!1}}self.wi=new t}"use strict";
{const k=(t,h)=>{let c=t[0],f=t[1],b=t[2],e=t[3];c=a(f&b|~f&e,c,f,h[0],7,-680876936);e=a(c&f|~c&b,e,c,h[1],12,-389564586);b=a(e&c|~e&f,b,e,h[2],17,606105819);f=a(b&e|~b&c,f,b,h[3],22,-1044525330);c=a(f&b|~f&e,c,f,h[4],7,-176418897);e=a(c&f|~c&b,e,c,h[5],12,1200080426);b=a(e&c|~e&f,b,e,h[6],17,-1473231341);f=a(b&e|~b&c,f,b,h[7],22,-45705983);c=a(f&b|~f&e,c,f,h[8],7,1770035416);e=a(c&f|~c&b,e,c,h[9],12,-1958414417);b=a(e&c|~e&f,b,e,h[10],17,-42063);f=a(b&e|~b&c,f,b,h[11],22,-1990404162);c=a(f&b|~f&
e,c,f,h[12],7,1804603682);e=a(c&f|~c&b,e,c,h[13],12,-40341101);b=a(e&c|~e&f,b,e,h[14],17,-1502002290);f=a(b&e|~b&c,f,b,h[15],22,1236535329);c=a(f&e|b&~e,c,f,h[1],5,-165796510);e=a(c&b|f&~b,e,c,h[6],9,-1069501632);b=a(e&f|c&~f,b,e,h[11],14,643717713);f=a(b&c|e&~c,f,b,h[0],20,-373897302);c=a(f&e|b&~e,c,f,h[5],5,-701558691);e=a(c&b|f&~b,e,c,h[10],9,38016083);b=a(e&f|c&~f,b,e,h[15],14,-660478335);f=a(b&c|e&~c,f,b,h[4],20,-405537848);c=a(f&e|b&~e,c,f,h[9],5,568446438);e=a(c&b|f&~b,e,c,h[14],9,-1019803690);
b=a(e&f|c&~f,b,e,h[3],14,-187363961);f=a(b&c|e&~c,f,b,h[8],20,1163531501);c=a(f&e|b&~e,c,f,h[13],5,-1444681467);e=a(c&b|f&~b,e,c,h[2],9,-51403784);b=a(e&f|c&~f,b,e,h[7],14,1735328473);f=a(b&c|e&~c,f,b,h[12],20,-1926607734);c=a(f^b^e,c,f,h[5],4,-378558);e=a(c^f^b,e,c,h[8],11,-2022574463);b=a(e^c^f,b,e,h[11],16,1839030562);f=a(b^e^c,f,b,h[14],23,-35309556);c=a(f^b^e,c,f,h[1],4,-1530992060);e=a(c^f^b,e,c,h[4],11,1272893353);b=a(e^c^f,b,e,h[7],16,-155497632);f=a(b^e^c,f,b,h[10],23,-1094730640);c=a(f^
b^e,c,f,h[13],4,681279174);e=a(c^f^b,e,c,h[0],11,-358537222);b=a(e^c^f,b,e,h[3],16,-722521979);f=a(b^e^c,f,b,h[6],23,76029189);c=a(f^b^e,c,f,h[9],4,-640364487);e=a(c^f^b,e,c,h[12],11,-421815835);b=a(e^c^f,b,e,h[15],16,530742520);f=a(b^e^c,f,b,h[2],23,-995338651);c=a(b^(f|~e),c,f,h[0],6,-198630844);e=a(f^(c|~b),e,c,h[7],10,1126891415);b=a(c^(e|~f),b,e,h[14],15,-1416354905);f=a(e^(b|~c),f,b,h[5],21,-57434055);c=a(b^(f|~e),c,f,h[12],6,1700485571);e=a(f^(c|~b),e,c,h[3],10,-1894986606);b=a(c^(e|~f),b,
e,h[10],15,-1051523);f=a(e^(b|~c),f,b,h[1],21,-2054922799);c=a(b^(f|~e),c,f,h[8],6,1873313359);e=a(f^(c|~b),e,c,h[15],10,-30611744);b=a(c^(e|~f),b,e,h[6],15,-1560198380);f=a(e^(b|~c),f,b,h[13],21,1309151649);c=a(b^(f|~e),c,f,h[4],6,-145523070);e=a(f^(c|~b),e,c,h[11],10,-1120210379);b=a(c^(e|~f),b,e,h[2],15,718787259);f=a(e^(b|~c),f,b,h[9],21,-343485551);t[0]=c+t[0]&4294967295;t[1]=f+t[1]&4294967295;t[2]=b+t[2]&4294967295;t[3]=e+t[3]&4294967295},a=(t,h,c,f,b,e)=>{h=(h+t&4294967295)+(f+e&4294967295)&
4294967295;return(h<<b|h>>>32-b)+c&4294967295},d=t=>{const h=t.length,c=[1732584193,-271733879,-1732584194,271733878];let f;for(f=64;f<=t.length;f+=64){{var b=t.substring(f-64,f);const e=[];for(let p=0;64>p;p+=4)e[p>>2]=b.charCodeAt(p)+(b.charCodeAt(p+1)<<8)+(b.charCodeAt(p+2)<<16)+(b.charCodeAt(p+3)<<24);b=e}k(c,b)}t=t.substring(f-64);b=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(f=0;f<t.length;f++)b[f>>2]|=t.charCodeAt(f)<<(f%4<<3);b[f>>2]|=128<<(f%4<<3);if(55<f)for(k(c,b),f=0;16>f;f++)b[f]=0;b[14]=8*
h;k(c,b);return c},g="0123456789abcdef".split(""),n=t=>{for(let f=0;f<t.length;f++){var h=f;{var c=t[f];let b="";for(let e=0;4>e;e++)b+=g[c>>8*e+4&15]+g[c>>8*e&15];c=b}t[h]=c}return t.join("")};n(d("hello"));self.ug=t=>n(d(t))}"use strict";
{const k=self.Mb,a=self.wi,d=self.vi,g=self.zi,n=self.Di,t=self.Ei;let h=null,c=null,f=null,b=null,e=null;const p={CreateBannerAdvert:async(r,v,x,C,D)=>{await k.Na(D,x)&&(x=await a.mb,h||(h=new d(r,v,C,D)),h.Ja(x,D))},ShowBannerAdvert:async r=>{if(!h)return k.I(r,"banner ad not created");h.Db(r)},HideBannerAdvert:async r=>{if(!h)return k.I(r,"banner ad not created");h.hj(r)},CreateInterstitialAdvert:async(r,v,x)=>{if(c)return k.P(x,"interstitial ad already created");await k.Na(x,v)&&(v=await a.mb,
c=new g(r,x),c.Ja(v,x))},ShowInterstitialAdvert:async r=>{if(!c)return k.I(r,"interstitial ad not created");c.Db(r)},CreateVideoAdvert:async(r,v,x)=>{if(f||b)return k.P(x,"video ad already created");await k.Na(x,v)&&(v=await a.mb,f=new n(r,x),f.Ja(v,x))},ShowVideoAdvert:async r=>{if(!f)return k.I(r,"video ad not created");f.Db(r)},CreateRewardedAdvert:async(r,v,x)=>{if(b||f)return k.P(x,"rewarded ad already created");await k.Na(x,v)&&(v=await a.mb,b=new n(r,x),b.Ja(v,x))},ShowRewardedAdvert:async r=>
{if(!b)return k.I(r,"rewarded ad not created");b.Db(r)},CreateRewardedInterstitialAdvert:async(r,v,x)=>{if(e)return k.P(x,"rewarded interstitial ad already created");await k.Na(x,v)&&(v=await a.mb,e=new t(r,x),e.Ja(v,x))},ShowRewardedInterstitialAdvert:async r=>{if(!e)return k.I(r,"rewarded interstitial ad not created");e.Db(r)},Configure:async(r,v,x,C,D,H,m,q,w)=>{const l=!k.ej();k.Nj(r,v,x,C,D,H,m);if(!await k.Na(w,H))return a.Le(w,"failure to initialize");l&&await a.Ye();if(!await a.Hj(H,m,w))return a.Le(w,
"failure to update consent information");l?q?await a.cf("eu"):await a.Sg():await a.cf("always");await a.ik(w)},RequestConsent:async r=>{p.Configure(k.Nb.id,k.Nb.fn,k.Nb.dn,k.Nb.kn,"always",k.Nb.debug,k.Nb.Xm,!1,r)},SetMaxAdContentRating:async(r,v)=>{if(await k.Na(v)){if(!r)return k.I(v,"Label not specified");try{k.ff("maxAdContentRating",r),k.P(v,"")}catch(x){k.I(v,"invalid label")}}},TagForChildDirectedTreatment:async(r,v)=>{if(await k.Na(v))try{k.ff("tagForChildDirectedTreatment",1===r?!0:!1),k.P(v,
"")}catch(x){k.I(v,"invalid label")}},TagForUnderAgeOfConsent:async(r,v)=>{if(await k.Na(v))try{k.ff("tagForUnderAgeOfConsent",1===r?!0:!1),k.P(v,"")}catch(x){k.I(v,"invalid label")}},RequestIDFA:async r=>{await k.Na(r)&&a.Gj(r)},StatusUpdate:async(r,v,x)=>{if(!await k.Na(x,r))return a.Le(x,"failure to initialize");await a.Ij(r,v);await a.hk(x)}};self.Ta||(self.Ta={});self.Ta.gn=p}"use strict";
{const k={},a=(b,e)=>k[b]=e,d=b=>new Promise(e=>setTimeout(e,b));let g=null,n=null,t=null,h=null,c=null;function f(b,e){const p=e.slice(0,-1);e=e[e.length-1];console.log(b,p);return[p,e]}a("CreateBannerAdvert",async(...b)=>{[,b]=f("CreateBannerAdvert",b);await d(50);g?b("Banner already exists"):(g="ready",b(null,"Created banner"))});a("ShowBannerAdvert",async(...b)=>{[,b]=f("ShowBannerAdvert",b);await d(50);"ready"!=g?b("Banner cannot be shown"):(g="shown",b(null,"Showed banner"))});a("HideBannerAdvert",
async(...b)=>{[,b]=f("HideBannerAdvert",b);await d(50);"shown"!=g?b("Banner cannot be hidden"):(g=null,b(null,"Hid banner"))});a("CreateInterstitialAdvert",async(...b)=>{[,b]=f("CreateInterstitialAdvert",b);await d(50);n?b("Intersitial already exists"):(n="ready",b(null,"Created interstitial"))});a("ShowInterstitialAdvert",async(...b)=>{[,b]=f("ShowInterstitialAdvert",b);await d(50);"ready"!=n?b("Cannot show interstitial"):(n=null,b(null,"Interstitial shown"))});a("CreateVideoAdvert",async(...b)=>
{[,b]=f("CreateVideoAdvert",b);await d(50);t?b("Video already exists"):(t="ready",b(null,"Created video"))});a("ShowVideoAdvert",async(...b)=>{[,b]=f("ShowVideoAdvert",b);await d(50);"ready"!=t?b("Cannot show video"):(t=null,b(null,'["example type", 20]'))});a("CreateRewardedAdvert",async(...b)=>{[,b]=f("CreateRewardedAdvert",b);await d(50);h?b("Rewarded already exists"):(h="ready",b(null,"Created rewarded"))});a("ShowRewardedAdvert",async(...b)=>{[,b]=f("ShowRewardedAdvert",b);await d(50);"ready"!=
h?b("Cannot show rewarded"):(h=null,b(null,'["example type", 20]'))});a("CreateRewardedInterstitialAdvert",async(...b)=>{[,b]=f("CreateRewardedInterstitialAdvert",b);await d(50);c?b("Rewarded intersitial already exists"):(c="ready",b(null,"Created rewarded interstitial"))});a("ShowRewardedInterstitialAdvert",async(...b)=>{[,b]=f("ShowRewardedInterstitialAdvert",b);await d(50);"ready"!=c?b("Cannot show rewarded interstitial"):(c=null,b(null,"Rewarded interstitial shown"))});a("Configure",async(...b)=>
{[,b]=f("Configure",b);await d(50);b(null,"PERSONALIZED&&true")});a("RequestConsent",async(...b)=>{[,b]=f("RequestConsent",b);await d(50);b(null,"PERSONALIZED&&true")});a("RequestIDFA",async(...b)=>{[,b]=f("RequestIDFA",b);await d(50);b(null,"authorized")});self.Ta||(self.Ta={});self.Ta.En=k}"use strict";
{const k=self.Mb,a={};let d=!1,g=null;const n=async c=>{if(!a.webAdsScriptLoaded)return k.I(c,"advert script not loaded, likely blocked by an ad blocker"),!1;d||(self.adsbygoogle=self.adsbygoogle||[],self.adBreak=self.adConfig=f=>self.adsbygoogle.push(f),d=!0);return g?g:g=new Promise(f=>{self.adConfig({preloadAdBreaks:"on",onReady:()=>f(!0)})})},t=()=>{a.domSideHandler.L.Hc("runtime","visibilitychange",{hidden:!0})},h=()=>{a.domSideHandler.L.Hc("runtime","visibilitychange",{hidden:!1})};a.CreateBannerAdvert=
async(c,f,b,e,p)=>{k.I(p,"banner ads not supported in web platform")};a.ShowBannerAdvert=async c=>{k.I(c,"banner ads not supported in web platform")};a.HideBannerAdvert=async c=>{k.I(c,"banner ads not supported in web platform")};a.CreateInterstitialAdvert=async(c,f,b)=>{await n(b)&&k.P(b,"interstitial ad created")};a.ShowInterstitialAdvert=async c=>{await n(c)&&self.adBreak({type:"next",beforeAd:()=>t(),afterAd:()=>h(),adBreakDone:f=>{switch(f.breakStatus){case "viewed":case "dismissed":k.P(c,"interstitial ad show");
break;default:console.table(f),k.I(c,"interstitial ad failed to show")}}})};a.CreateVideoAdvert=async(c,f,b)=>{k.I(b,"video ads are deprecated")};a.ShowVideoAdvert=async c=>{k.I(c,"video ads are deprecated")};a.CreateRewardedAdvert=async(c,f,b)=>{await n(b)&&k.P(b,"rewarded ad created")};a.ShowRewardedAdvert=async c=>{await n(c)&&self.adBreak({type:"reward",beforeAd:()=>t(),afterAd:()=>h(),adBreakDone:f=>{switch(f.breakStatus){case "viewed":case "dismissed":k.P(c,"rewarded ad show");break;case "ignored":k.I(c,
"rewarded ad ignored");break;default:console.table(f),k.I(c,"rewarded ad failed to show")}},beforeReward:f=>{f()},adDismissed:()=>{k.I(c,"closed with no reward")},adViewed:()=>{k.P(c,JSON.stringify(["Reward",1]))}})};a.CreateRewardedInterstitialAdvert=async(c,f,b)=>{await n(b)&&k.P(b,"rewarded interstitial ad created")};a.ShowRewardedInterstitialAdvert=async c=>{await n(c)&&self.adBreak({type:"reward",beforeAd:()=>t(),afterAd:()=>h(),adBreakDone:f=>{switch(f.breakStatus){case "viewed":case "dismissed":k.P(c,
"rewarded interstitial ad show");break;case "ignored":k.I(c,"rewarded interstitial ad ignored");break;default:console.table(f),k.I(c,"rewarded interstitial ad failed to show")}},beforeReward:f=>{f()},adDismissed:()=>{k.I(c,"closed with no reward")},adViewed:()=>{k.P(c,JSON.stringify(["Reward",1]))}})};a.Configure=async(c,f,b,e,p,r,v,x,C)=>{a.webAdsScriptLoaded?k.P(C,"UNKNOWN&&not-determined&&true"):k.I(C,"advert script not loaded, likely blocked by an ad blocker")};a.RequestConsent=async c=>{k.P(c,
"UNKNOWN&&not-determined&&true")};a.SetMaxAdContentRating=async(c,f)=>{k.I(f,"setting max ad content rating not supported in web platform")};a.TagForChildDirectedTreatment=async(c,f)=>{k.I(f,"tagging for children not supported in web platform")};a.TagForUnderAgeOfConsent=async(c,f)=>{k.I(f,"tagging for under age of consent not supported in web platform")};a.RequestIDFA=async c=>{k.P(c,"not-determined")};a.StatusUpdate=async(c,f,b)=>{k.P(b,"UNKNOWN&&not-determined&&true")};self.Ta||(self.Ta={});self.Ta.qn=
a}"use strict";
{let k=!1;self.Ua.Lb(class extends self.zb{constructor(a){super(a,"advert");a=d=>[d,g=>this.wk(d,g)];M(this,[a("CreateBannerAdvert"),a("ShowBannerAdvert"),a("HideBannerAdvert"),a("CreateInterstitialAdvert"),a("ShowInterstitialAdvert"),a("CreateVideoAdvert"),a("ShowVideoAdvert"),a("CreateRewardedAdvert"),a("ShowRewardedAdvert"),a("CreateRewardedInterstitialAdvert"),a("ShowRewardedInterstitialAdvert"),a("Configure"),a("RequestConsent"),a("SetUserPersonalisation"),a("SetMaxAdContentRating"),a("TagForChildDirectedTreatment"),
a("TagForUnderAgeOfConsent"),a("RequestIDFA"),a("StatusUpdate"),(d=>[d,g=>this.sk(g[0],g[1])])("AddScript")])}Zg(){if(self.cordova)return self.Ta.gn;if(!self.cordova)return self.Ta.qn}async wk(a,d){const g=this.Zg();g.domSideHandler||(g.domSideHandler=this);if(!g)throw k||(k=!0,console.warn("The Mobile Advert plugin is not loaded. Please note that it only works in Android or iOS exports")),Error("advert plugin not loaded");return new Promise((n,t)=>{(0,g[a])(...d,(h,c)=>{h?t(h):n(c)})})}async sk(a,
d=null){const g=this.Zg();g.webAdsScriptLoaded=!1;return new Promise(n=>{const t=document.createElement("script");if(d)for(let h in d)t.setAttribute(h,d[h]);t.onload=function(){g.webAdsScriptLoaded=!0;n()};t.onerror=function(){g.webAdsScriptLoaded=!1;n()};t.src=a;document.head.appendChild(t)})}})};
